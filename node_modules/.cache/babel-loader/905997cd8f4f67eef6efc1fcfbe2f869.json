{"ast":null,"code":"var _jsxFileName = \"C:\\\\mapboxAndReact\\\\src\\\\index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport mapboxgl from 'mapbox-gl';\nimport axios from 'axios';\nimport Select from 'react-select';\nimport sci from './sci.json';\nimport countryData from './country.json';\nimport classes from './Site.module.css';\nimport { BarChart, Cell, Bar, Tooltip, XAxis, YAxis } from 'recharts'; //iso_3166_1_alpha_3\n///6808: 520  baseline\n//// divide 20% percentile per country//////\n//// Access token for Africapolis mapbox account\n\nmapboxgl.accessToken = 'pk.eyJ1IjoibWttZCIsImEiOiJjajBqYjJpY2owMDE0Mndsbml0d2V1ZXczIn0.el8wQmA-TSJp2ggX8fJ1rA';\nconst colors = [\"#F3F2E8\", \"#D4EBE2\", \"#B6E3DB\", \"#97DCD5\", \"#79D5CF\", \"#5ACEC9\", \"#3CC6C2\", \"#1DBFBC\", \"#333333\"]; //////////////////\n// sort array ascending\n\nconsole.log(countryData[\"AF\"]);\nlet top5_list = [[], [], [], [], []];\nlet result = [];\n\nconst asc = arr => arr.sort((a, b) => a - b);\n\nconst sum = arr => arr.reduce((a, b) => a + b, 0);\n\nconst mean = arr => sum(arr) / arr.length;\n\nconst quantile = (arr, q) => {\n  const sorted = asc(arr);\n  const pos = (sorted.length - 1) * q;\n  const base = Math.floor(pos);\n  const rest = pos - base;\n\n  if (sorted[base + 1] !== undefined) {\n    return sorted[base] + rest * (sorted[base + 1] - sorted[base]);\n  } else {\n    return sorted[base];\n  }\n};\n\nconst legend = /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"h4\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 3\n  }\n}, \"Social Connected Index\"), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"span\", {\n  style: {\n    backgroundColor: colors[0]\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 6\n  }\n}), \"< 1x (20th percentile selected country)\"), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"span\", {\n  style: {\n    backgroundColor: colors[1]\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 6\n  }\n}), \"1-2x\"), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"span\", {\n  style: {\n    backgroundColor: colors[2]\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 6\n  }\n}), \"2-3x\"), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"span\", {\n  style: {\n    backgroundColor: colors[3]\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 6\n  }\n}), \"3-5x\"), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"span\", {\n  style: {\n    backgroundColor: colors[4]\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 6\n  }\n}), \"5-10x\"), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"span\", {\n  style: {\n    backgroundColor: colors[5]\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 6\n  }\n}), \"10-25x\"), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"span\", {\n  style: {\n    backgroundColor: colors[6]\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 6\n  }\n}), \"25-100x\"), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"span\", {\n  style: {\n    backgroundColor: colors[7]\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 6\n  }\n}), \">= 100x\"), /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 1\n  }\n}, /*#__PURE__*/React.createElement(\"span\", {\n  style: {\n    backgroundColor: colors[8]\n  },\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 6\n  }\n}), \"Data not available\"));\nconst agglomeration_fill_color = [\"step\", [\"get\", \"Population_2015\"], \"hsla(0, 0%, 8%, 0.5)\", 10000, \"hsla(55, 30%, 93%, 0.5)\", 30000, \"hsla(60, 100%, 90%, 0.5)\", 100000, \"hsla(98, 55%, 81%, 0.5)\", 300000, \"hsla(166, 44%, 65%, 0.5)\", 1000000, \"hsla(186, 53%, 51%, 0.5)\", 3000000, \"hsla(197, 74%, 43%, 0.5)\", 11847635, \"hsla(197, 74%, 43%, 0.5)\"];\nconst agglomeration_stroke_color = [\"step\", [\"get\", \"Population_2015\"], \"hsla(0, 0%, 8%, 1)\", 10000, \"hsla(55, 30%, 93%, 1)\", 30000, \"hsla(60, 100%, 90%, 1)\", 100000, \"hsla(98, 55%, 81%, 1)\", 300000, \"hsla(166, 44%, 65%, 1)\", 1000000, \"hsla(186, 53%, 51%, 1)\", 3000000, \"hsla(197, 74%, 43%, 1)\", 11847635, \"hsla(197, 74%, 43%, 1)\"]; // const options = [];\n// country_label.map(v=>{return options.push({label:v, value:v})});\n// Values.map(v=>{return options.push({label:agglo_label[v[1]-1]+\", \"+country_label[v[0]-1], value:v})});\n// console.log(Values.map(v=>{return {label:agglo_label[v[1]]+\", \"+country_label[v[0]], value:v}}))\n//// Basic setting of the map\n\nclass Application extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onUpdate = update => {\n      this.setState({\n        update\n      });\n    };\n\n    this.onChange = values => {\n      this.setState({\n        values\n      });\n    };\n\n    this.onFilter = filters => {\n      this.setState({\n        [filters.target.id]: !this.state[filters.target.id]\n      });\n    };\n\n    this.remove = obj => {\n      this.map.removeLayer(obj);\n    };\n\n    this.add_shape = (obj, filter1) => {\n      this.map.addLayer({\n        id: obj,\n        source: 'africapolis_country',\n        type: 'fill',\n        'source-layer': 'africacontinent_complete-ays128',\n        filter: filter1,\n        paint: {\n          'fill-color': '#fdfdf5',\n          'fill-opacity': [\"interpolate\", [\"linear\"], [\"zoom\"], 0, 1, 5, 0] //8.5\n\n        }\n      } // layer order\n      ); //console.log(this.map.getSource(\"africapolis_country\"))\n    };\n\n    this.state = {\n      lng: 5,\n      lat: 0,\n      zoom: 2,\n      selectedOption: {\n        label: 'Africa',\n        value: ''\n      },\n      selectedCountry: \"AE\",\n      name: \"Click the country to check SCI\"\n    };\n  }\n\n  componentDidMount() {\n    //// Initial map setting\n    let selected = [];\n    let scidata = [];\n    sci.map(e => e.start === this.state.selectedCountry ? selected.push(e) : null);\n    console.log(selected);\n    selected.map(e => scidata.push(e.sci));\n    console.log(scidata);\n    console.log(quantile(scidata, .20)); //Object.keys(selected).map(e => console.log(e))\n\n    this.map = new mapboxgl.Map({\n      container: this.mapContainer,\n      style: 'mapbox://styles/mkmd/ckguwdhux0j7719p9rz2hpmpi',\n      /// Select mapstyle from mapbox studio\n      center: [this.state.lng, this.state.lat],\n      zoom: this.state.zoom\n    }); // this.map.on('move', () => {\n    //   this.setState({\n    //   lng: this.map.getCenter().lng.toFixed(4),\n    //   lat: this.map.getCenter().lat.toFixed(4),\n    //   zoom: this.map.getZoom().toFixed(2)\n    //   });\n    // });\n    //// Import Africapolis agglomerations from mapbox\n\n    this.map.on('load', () => {\n      // Add Country shape\n      this.map.addSource('africapolis_country', {\n        type: 'vector',\n        url: 'mapbox://mapbox.country-boundaries-v1'\n      }); // Add Agglomerations\n      //    this.map.addSource('africapolis_agglos', { type: 'vector', url: 'mapbox://mkmd.3e0rk98j'});\n      // Add Country label\n\n      this.map.addSource('africapolis_country_label', {\n        type: 'vector',\n        url: 'mapbox://mapbox.mapbox-streets-v8'\n      }); // Add Region labelled\n      //    this.map.addSource('africapolis_region_label', { type: 'vector', url: 'mapbox://mkmd.3yut44ue'});\n      // Add Country layer\n\n      this.map.addLayer({\n        id: 'country',\n        source: 'africapolis_country',\n        type: 'fill',\n        'source-layer': 'country_boundaries',\n        //filter:[\"==\",\"Region_ID\",1],\n        paint: {\n          'fill-color': '#fdfdf5',\n          'fill-opacity': ['case', ['boolean', ['feature-state', 'hover'], false], 0.2, 0]\n        }\n      });\n      this.map.addLayer({\n        id: 'country_labels',\n        source: 'africapolis_country_label',\n        type: 'symbol',\n        'source-layer': 'place_label',\n        //filter:[  \"match\",  [\"get\", \"class\"],  \"country\",  [    \"match\",    [\"get\", \"worldview\"],    [\"all\", \"US\"],    true,    false  ],  \"disputed_country\",  [    \"all\",    [      \"==\",      [\"get\", \"disputed\"],      \"true\"    ],    [      \"match\",      [\"get\", \"worldview\"],      [\"all\", \"US\"],      true,      false    ]  ],  false],\n        layout: {\n          'text-field': [\"get\", \"name_en\"],\n          'text-font': [\"DIN Pro Medium\", \"Arial Unicode MS Regular\"] //'text-size': [\"interpolate\", [\"linear\"], [\"zoom\"], 2, [\"step\", [\"get\", \"scalerank\"], 10, 3, 8, 5, 5 ], 9, [\"step\", [\"get\", \"scalerank\"], 35, 3, 27, 5, 22 ] ],\n\n        },\n        paint: {\n          //'text-opacity':[ \"step\",[\"zoom\"],  0,  3,  1,  22,  1],\n          'text-color': ['case', ['boolean', ['feature-state', 'hover'], false], \"hsl(0,0%,0%)\", \"hsl(215, 30%, 75%)\"] //'text-halo-color': \"hsl(0, 0%, 100%)\",\n          //'text-halo-width': 1.25\n\n        }\n      });\n      this.map.on('click', 'country', e => {\n        //console.log(e.features[0].properties.iso_3166_1)\n        this.setState({\n          selectedCountry: e.features[0].properties.iso_3166_1\n        });\n        let selected = [];\n        let scidata = [];\n        sci.map(e => e.start === this.state.selectedCountry ? selected.push(e) : null);\n        selected.map(e => scidata.push(e.sci));\n        let percentile20 = quantile(scidata, .20); //selected.map(e => e.sci = e.sci/ percentile20)\n\n        console.log(selected);\n        let top5 = scidata.sort((a, b) => b - a).slice(0, 5);\n        selected.map(e => {\n          e.region = countryData[e.end][1];\n          e.sciScaled = Math.round(e.sci / percentile20);\n\n          if (e.sci === top5[0]) {\n            top5_list[0] = e;\n          } else if (e.sci === top5[1]) {\n            top5_list[1] = e;\n          } else if (e.sci === top5[2]) {\n            top5_list[2] = e;\n          } else if (e.sci === top5[3]) {\n            top5_list[3] = e;\n          } else if (e.sci === top5[4]) {\n            top5_list[4] = e;\n          }\n        });\n        console.log(selected); //top5_list.map(e => e.sciScaled= Math.round(e.sci/percentile20))\n\n        console.log(top5);\n        console.log(top5_list); // Calculate the sums and group data (while tracking count)\n\n        const reduced = selected.reduce(function (m, d) {\n          if (!m[d.region]) {\n            m[d.region] = { ...d,\n              count: 1\n            };\n            return m;\n          }\n\n          m[d.region].sciScaled += d.sciScaled;\n          m[d.region].count += 1;\n          return m;\n        }, {}); // Create new array from grouped data and compute the average\n\n        result = Object.keys(reduced).map(function (k) {\n          const item = reduced[k];\n          return {\n            region: item.region,\n            sciScaled: Math.round(item.sciScaled / item.count * 100) / 100\n          };\n        });\n        console.log(result); // console.log(JSON.stringify(result,null,4));\n\n        this.setState({\n          name: e.features[0].properties.name_en\n        });\n        let matchExpression = ['match', ['get', 'iso_3166_1']]; // Calculate color values for each country based on 'hdi' value\n\n        selected.forEach(e => {\n          // 1 2 3 5 10 25 100 above100\n          //e.sci = e.sci/percentile20\n          if (e.sci / percentile20 < 1) {\n            matchExpression.push(e['end'], \"#F3F2E8\");\n          } else if (e.sci / percentile20 < 2) {\n            matchExpression.push(e['end'], \"#D4EBE2\");\n          } else if (e.sci / percentile20 < 3) {\n            matchExpression.push(e['end'], \"#B6E3DB\");\n          } else if (e.sci / percentile20 < 5) {\n            matchExpression.push(e['end'], \"#97DCD5\");\n          } else if (e.sci / percentile20 < 10) {\n            matchExpression.push(e['end'], \"#79D5CF\");\n          } else if (e.sci / percentile20 < 25) {\n            matchExpression.push(e['end'], \"#5ACEC9\");\n          } else if (e.sci / percentile20 < 100) {\n            matchExpression.push(e['end'], \"#3CC6C2\");\n          } else {\n            matchExpression.push(e['end'], \"#1DBFBC\");\n          }\n        });\n        matchExpression.push(this.state.selectedCountry, 'yellow'); //console.log(matchExpression)\n        // Last value is the default, used where there is no data\n\n        matchExpression.push('rgba(0, 0, 0, 0)'); // //console.log(this.state.selectedOption, prevState.selectedOption);\n\n        this.remove('country');\n        console.log(matchExpression);\n        this.map.addLayer({\n          id: 'country',\n          source: 'africapolis_country',\n          type: 'fill',\n          'source-layer': 'country_boundaries',\n          //filter:[\"==\",\"Region_ID\",1],\n          paint: {\n            'fill-color': matchExpression,\n            'fill-opacity': 0.9\n          }\n        });\n        this.remove('country_labels');\n        this.map.addLayer({\n          id: 'country_labels',\n          source: 'africapolis_country_label',\n          type: 'symbol',\n          'source-layer': 'place_label',\n          //filter:[  \"match\",  [\"get\", \"class\"],  \"country\",  [    \"match\",    [\"get\", \"worldview\"],    [\"all\", \"US\"],    true,    false  ],  \"disputed_country\",  [    \"all\",    [      \"==\",      [\"get\", \"disputed\"],      \"true\"    ],    [      \"match\",      [\"get\", \"worldview\"],      [\"all\", \"US\"],      true,      false    ]  ],  false],\n          layout: {\n            'text-field': [\"get\", \"name_en\"],\n            'text-font': [\"DIN Pro Medium\", \"Arial Unicode MS Regular\"] //'text-size': [\"interpolate\", [\"linear\"], [\"zoom\"], 2, [\"step\", [\"get\", \"scalerank\"], 10, 3, 8, 5, 5 ], 9, [\"step\", [\"get\", \"scalerank\"], 35, 3, 27, 5, 22 ] ],\n\n          },\n          paint: {\n            //'text-opacity':[ \"step\",[\"zoom\"],  0,  3,  1,  22,  1],\n            'text-color': ['case', ['boolean', ['feature-state', 'hover'], false], \"hsl(0,0%,0%)\", \"hsl(215, 30%, 75%)\"] //'text-halo-color': \"hsl(0, 0%, 100%)\",\n            //'text-halo-width': 1.25\n\n          }\n        });\n      });\n      var hoveredID = null;\n      this.map.on('mouseenter', 'country', e => {\n        if (e.features.length > 0) {\n          if (hoveredID) {\n            this.map.setFeatureState({\n              source: 'africapolis_country',\n              id: hoveredID,\n              sourceLayer: 'country_boundaries'\n            }, {\n              hover: false\n            });\n          }\n\n          hoveredID = e.features[0].id;\n          this.map.setFeatureState({\n            source: 'africapolis_country',\n            id: hoveredID,\n            sourceLayer: 'country_boundaries'\n          }, {\n            hover: true\n          });\n        }\n      });\n      this.map.on('mouseleave', 'country', e => {\n        if (hoveredID) {\n          this.map.setFeatureState({\n            source: 'africapolis_country',\n            id: hoveredID,\n            sourceLayer: 'country_boundaries'\n          }, {\n            hover: false\n          });\n        }\n\n        hoveredID = null;\n      });\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    //if( prevState.selectedOption !== this.state.selectedOption || prevState.update[0] !== this.state.update[0]) {\n    if (prevState !== this.state) {}\n  }\n\n  render() {\n    const {\n      selectedOption\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.topleft,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }\n    }, \" \", this.state.name, \" \", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 61\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 11\n      }\n    }), \" \", top5_list[0].end ? \"Five countries with the highest SCI\" : null, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 11\n      }\n    }), \" \", top5_list[0].end ? \"1. \" + countryData[top5_list[0].end][0] : null, top5_list[0].end ? \", \" + countryData[top5_list[0].end][1] : null, \" \", top5_list[0].sciScaled, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 11\n      }\n    }), \" \", top5_list[1].end ? \"2. \" + countryData[top5_list[1].end][0] : null, top5_list[1].end ? \", \" + countryData[top5_list[1].end][1] : null, \"  \", top5_list[1].sciScaled, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 11\n      }\n    }), \" \", top5_list[2].end ? \"3. \" + countryData[top5_list[2].end][0] : null, top5_list[2].end ? \", \" + countryData[top5_list[2].end][1] : null, \"  \", top5_list[2].sciScaled, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 11\n      }\n    }), \" \", top5_list[3].end ? \"4. \" + countryData[top5_list[3].end][0] : null, top5_list[3].end ? \", \" + countryData[top5_list[3].end][1] : null, \"  \", top5_list[3].sciScaled, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 11\n      }\n    }), \" \", top5_list[4].end ? \"5. \" + countryData[top5_list[4].end][0] : null, top5_list[4].end ? \", \" + countryData[top5_list[4].end][1] : null, \"  \", top5_list[4].sciScaled, console.log(result), /*#__PURE__*/React.createElement(BarChart, {\n      width: 380,\n      height: 65,\n      data: result,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(XAxis, {\n      dataKey: \"region\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Bar, {\n      dataKey: \"sciScaled\",\n      fill: \"#8884d8\",\n      id: \"region\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(Tooltip, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 15\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 9\n      }\n    }, \"Longitude: \", this.state.lng, \" | Latitude: \", this.state.lat, \" | Zoom: \", this.state.zoom), /*#__PURE__*/React.createElement(\"div\", {\n      ref: el => this.mapContainer = el,\n      className: classes.mapContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.legend,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 9\n      }\n    }, legend));\n  }\n\n}\n\nReactDOM.render( /*#__PURE__*/React.createElement(Application, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 415,\n    columnNumber: 17\n  }\n}), document.getElementById('app'));","map":{"version":3,"sources":["C:/mapboxAndReact/src/index.js"],"names":["React","ReactDOM","mapboxgl","axios","Select","sci","countryData","classes","BarChart","Cell","Bar","Tooltip","XAxis","YAxis","accessToken","colors","console","log","top5_list","result","asc","arr","sort","a","b","sum","reduce","mean","length","quantile","q","sorted","pos","base","Math","floor","rest","undefined","legend","backgroundColor","agglomeration_fill_color","agglomeration_stroke_color","Application","Component","constructor","props","onUpdate","update","setState","onChange","values","onFilter","filters","target","id","state","remove","obj","map","removeLayer","add_shape","filter1","addLayer","source","type","filter","paint","lng","lat","zoom","selectedOption","label","value","selectedCountry","name","componentDidMount","selected","scidata","e","start","push","Map","container","mapContainer","style","center","on","addSource","url","layout","features","properties","iso_3166_1","percentile20","top5","slice","region","end","sciScaled","round","reduced","m","d","count","Object","keys","k","item","name_en","matchExpression","forEach","hoveredID","setFeatureState","sourceLayer","hover","componentDidUpdate","prevProps","prevState","render","topleft","el","document","getElementById"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,OAAOC,GAAP,MAAgB,YAAhB;AACA,OAAOC,WAAP,MAAwB,gBAAxB;AACA,OAAOC,OAAP,MAAoB,mBAApB;AACA,SAASC,QAAT,EAAmBC,IAAnB,EAAyBC,GAAzB,EAA8BC,OAA9B,EAAuCC,KAAvC,EAA8CC,KAA9C,QAA2D,UAA3D,C,CAEA;AACA;AACA;AAEA;;AACAX,QAAQ,CAACY,WAAT,GAAuB,uFAAvB;AAEA,MAAMC,MAAM,GAAG,CAAC,SAAD,EAAW,SAAX,EAAqB,SAArB,EAA+B,SAA/B,EAAyC,SAAzC,EAAmD,SAAnD,EAA6D,SAA7D,EAAuE,SAAvE,EAAiF,SAAjF,CAAf,C,CAIA;AAEA;;AACAC,OAAO,CAACC,GAAR,CAAYX,WAAW,CAAC,IAAD,CAAvB;AACA,IAAIY,SAAS,GAAC,CAAC,EAAD,EAAI,EAAJ,EAAO,EAAP,EAAU,EAAV,EAAa,EAAb,CAAd;AACA,IAAIC,MAAM,GAAC,EAAX;;AAEA,MAAMC,GAAG,GAAGC,GAAG,IAAIA,GAAG,CAACC,IAAJ,CAAS,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,GAAGC,CAAvB,CAAnB;;AAEA,MAAMC,GAAG,GAAGJ,GAAG,IAAIA,GAAG,CAACK,MAAJ,CAAW,CAACH,CAAD,EAAIC,CAAJ,KAAUD,CAAC,GAAGC,CAAzB,EAA4B,CAA5B,CAAnB;;AAEA,MAAMG,IAAI,GAAGN,GAAG,IAAII,GAAG,CAACJ,GAAD,CAAH,GAAWA,GAAG,CAACO,MAAnC;;AAEA,MAAMC,QAAQ,GAAG,CAACR,GAAD,EAAMS,CAAN,KAAY;AACzB,QAAMC,MAAM,GAAGX,GAAG,CAACC,GAAD,CAAlB;AACA,QAAMW,GAAG,GAAG,CAACD,MAAM,CAACH,MAAP,GAAgB,CAAjB,IAAsBE,CAAlC;AACA,QAAMG,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWH,GAAX,CAAb;AACA,QAAMI,IAAI,GAAGJ,GAAG,GAAGC,IAAnB;;AACA,MAAIF,MAAM,CAACE,IAAI,GAAG,CAAR,CAAN,KAAqBI,SAAzB,EAAoC;AAChC,WAAON,MAAM,CAACE,IAAD,CAAN,GAAeG,IAAI,IAAIL,MAAM,CAACE,IAAI,GAAG,CAAR,CAAN,GAAmBF,MAAM,CAACE,IAAD,CAA7B,CAA1B;AACH,GAFD,MAEO;AACH,WAAOF,MAAM,CAACE,IAAD,CAAb;AACH;AACJ,CAVD;;AAYA,MAAMK,MAAM,gBACZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADF,eAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAK;AAAM,EAAA,KAAK,EAAE;AAACC,IAAAA,eAAe,EAAExB,MAAM,CAAC,CAAD;AAAxB,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAL,EAAwD,yCAAxD,CAFA,eAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAK;AAAM,EAAA,KAAK,EAAE;AAACwB,IAAAA,eAAe,EAAExB,MAAM,CAAC,CAAD;AAAxB,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAL,SAHA,eAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAK;AAAM,EAAA,KAAK,EAAE;AAACwB,IAAAA,eAAe,EAAExB,MAAM,CAAC,CAAD;AAAxB,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAL,SAJA,eAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAK;AAAM,EAAA,KAAK,EAAE;AAACwB,IAAAA,eAAe,EAAExB,MAAM,CAAC,CAAD;AAAxB,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAL,SALA,eAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAK;AAAM,EAAA,KAAK,EAAE;AAACwB,IAAAA,eAAe,EAAExB,MAAM,CAAC,CAAD;AAAxB,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAL,UANA,eAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAK;AAAM,EAAA,KAAK,EAAE;AAACwB,IAAAA,eAAe,EAAExB,MAAM,CAAC,CAAD;AAAxB,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAL,WAPA,eAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAK;AAAM,EAAA,KAAK,EAAE;AAACwB,IAAAA,eAAe,EAAExB,MAAM,CAAC,CAAD;AAAxB,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAL,YARA,eASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAK;AAAM,EAAA,KAAK,EAAE;AAACwB,IAAAA,eAAe,EAAExB,MAAM,CAAC,CAAD;AAAxB,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAL,EAAwD,SAAxD,CATA,eAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAK;AAAM,EAAA,KAAK,EAAE;AAACwB,IAAAA,eAAe,EAAExB,MAAM,CAAC,CAAD;AAAxB,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAL,EAAwD,oBAAxD,CAVA,CADA;AAgBA,MAAMyB,wBAAwB,GAAE,CAC9B,MAD8B,EAE9B,CAAC,KAAD,EAAQ,iBAAR,CAF8B,EAG9B,sBAH8B,EAI9B,KAJ8B,EAK9B,yBAL8B,EAM9B,KAN8B,EAO9B,0BAP8B,EAQ9B,MAR8B,EAS9B,yBAT8B,EAU9B,MAV8B,EAW9B,0BAX8B,EAY9B,OAZ8B,EAa9B,0BAb8B,EAc9B,OAd8B,EAe9B,0BAf8B,EAgB9B,QAhB8B,EAiB9B,0BAjB8B,CAAhC;AAmBC,MAAMC,0BAA0B,GAAE,CACjC,MADiC,EAEjC,CAAC,KAAD,EAAQ,iBAAR,CAFiC,EAGjC,oBAHiC,EAIjC,KAJiC,EAKjC,uBALiC,EAMjC,KANiC,EAOjC,wBAPiC,EAQjC,MARiC,EASjC,uBATiC,EAUjC,MAViC,EAWjC,wBAXiC,EAYjC,OAZiC,EAajC,wBAbiC,EAcjC,OAdiC,EAejC,wBAfiC,EAgBjC,QAhBiC,EAiBjC,wBAjBiC,CAAlC,C,CAoBD;AACA;AACA;AACA;AAIA;;AACA,MAAMC,WAAN,SAA0B1C,KAAK,CAAC2C,SAAhC,CAA0C;AACxCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAmPrBC,QAnPqB,GAmPVC,MAAM,IAAI;AACnB,WAAKC,QAAL,CAAc;AAAED,QAAAA;AAAF,OAAd;AACD,KArPoB;;AAAA,SAuPrBE,QAvPqB,GAuPVC,MAAM,IAAI;AACnB,WAAKF,QAAL,CAAc;AAAEE,QAAAA;AAAF,OAAd;AACD,KAzPoB;;AAAA,SA2PrBC,QA3PqB,GA2PVC,OAAO,IAAI;AACpB,WAAKJ,QAAL,CAAc;AAAC,SAACI,OAAO,CAACC,MAAR,CAAeC,EAAhB,GAAqB,CAAC,KAAKC,KAAL,CAAWH,OAAO,CAACC,MAAR,CAAeC,EAA1B;AAAvB,OAAd;AACD,KA7PoB;;AAAA,SA+PrBE,MA/PqB,GA+PZC,GAAG,IAAI;AACZ,WAAKC,GAAL,CAASC,WAAT,CAAqBF,GAArB;AACH,KAjQoB;;AAAA,SAmQrBG,SAnQqB,GAmQT,CAACH,GAAD,EAAKI,OAAL,KAAiB;AACzB,WAAKH,GAAL,CAASI,QAAT,CAAkB;AACdR,QAAAA,EAAE,EAAEG,GADU;AAEdM,QAAAA,MAAM,EAAC,qBAFO;AAGdC,QAAAA,IAAI,EAAE,MAHQ;AAId,wBAAe,iCAJD;AAKdC,QAAAA,MAAM,EAACJ,OALO;AAMdK,QAAAA,KAAK,EAAE;AACL,wBAAc,SADT;AAEL,0BAAgB,CAAC,aAAD,EAAe,CAAC,QAAD,CAAf,EAA0B,CAAC,MAAD,CAA1B,EAAoC,CAApC,EAAsC,CAAtC,EAAwC,CAAxC,EAA0C,CAA1C,CAFX,CAEwD;;AAFxD;AANO,OAAlB,CAWD;AAXC,QADyB,CAczB;AAEH,KAnRoB;;AAEjB,SAAKX,KAAL,GAAa;AACXY,MAAAA,GAAG,EAAE,CADM;AAEXC,MAAAA,GAAG,EAAE,CAFM;AAGXC,MAAAA,IAAI,EAAE,CAHK;AAIXC,MAAAA,cAAc,EAAE;AAACC,QAAAA,KAAK,EAAE,QAAR;AAAkBC,QAAAA,KAAK,EAAE;AAAzB,OAJL;AAKXC,MAAAA,eAAe,EAAE,IALN;AAMXC,MAAAA,IAAI,EAAE;AANK,KAAb;AAQD;;AACHC,EAAAA,iBAAiB,GAAG;AACpB;AAEA,QAAIC,QAAQ,GAAG,EAAf;AACA,QAAIC,OAAO,GAAE,EAAb;AACAxE,IAAAA,GAAG,CAACqD,GAAJ,CAAQoB,CAAC,IAAIA,CAAC,CAACC,KAAF,KAAU,KAAKxB,KAAL,CAAWkB,eAArB,GAAsCG,QAAQ,CAACI,IAAT,CAAcF,CAAd,CAAtC,GAAyD,IAAtE;AACA9D,IAAAA,OAAO,CAACC,GAAR,CAAY2D,QAAZ;AACAA,IAAAA,QAAQ,CAAClB,GAAT,CAAaoB,CAAC,IAAID,OAAO,CAACG,IAAR,CAAaF,CAAC,CAACzE,GAAf,CAAlB;AACAW,IAAAA,OAAO,CAACC,GAAR,CAAY4D,OAAZ;AACA7D,IAAAA,OAAO,CAACC,GAAR,CAAYY,QAAQ,CAACgD,OAAD,EAAU,GAAV,CAApB,EAToB,CAUpB;;AAIK,SAAKnB,GAAL,GAAW,IAAIxD,QAAQ,CAAC+E,GAAb,CAAiB;AAC3BC,MAAAA,SAAS,EAAE,KAAKC,YADW;AAE3BC,MAAAA,KAAK,EAAE,gDAFoB;AAE8B;AACzDC,MAAAA,MAAM,EAAE,CAAC,KAAK9B,KAAL,CAAWY,GAAZ,EAAiB,KAAKZ,KAAL,CAAWa,GAA5B,CAHmB;AAI3BC,MAAAA,IAAI,EAAE,KAAKd,KAAL,CAAWc;AAJU,KAAjB,CAAX,CAde,CAoBhB;AACA;AACA;AACA;AACA;AACA;AACA;AACJ;;AACI,SAAKX,GAAL,CAAS4B,EAAT,CAAY,MAAZ,EAAoB,MAAM;AAE9B;AACM,WAAK5B,GAAL,CAAS6B,SAAT,CAAmB,qBAAnB,EAA0C;AAAEvB,QAAAA,IAAI,EAAE,QAAR;AAAkBwB,QAAAA,GAAG,EAAE;AAAvB,OAA1C,EAHwB,CAI9B;AACE;AACF;;AACK,WAAK9B,GAAL,CAAS6B,SAAT,CAAmB,2BAAnB,EAAgD;AAAEvB,QAAAA,IAAI,EAAE,QAAR;AAAkBwB,QAAAA,GAAG,EAAE;AAAvB,OAAhD,EAPyB,CAQ9B;AACE;AAEF;;AACM,WAAK9B,GAAL,CAASI,QAAT,CAAkB;AACZR,QAAAA,EAAE,EAAE,SADQ;AAEZS,QAAAA,MAAM,EAAC,qBAFK;AAGZC,QAAAA,IAAI,EAAE,MAHM;AAIZ,wBAAe,oBAJH;AAKZ;AACAE,QAAAA,KAAK,EAAE;AAEL,wBAAc,SAFT;AAGL,0BAAgB,CAAC,MAAD,EAAQ,CAAC,SAAD,EAAY,CAAC,eAAD,EAAkB,OAAlB,CAAZ,EAAwC,KAAxC,CAAR,EAAuD,GAAvD,EAA2D,CAA3D;AAHX;AANK,OAAlB;AAcE,WAAKR,GAAL,CAASI,QAAT,CAAkB;AACZR,QAAAA,EAAE,EAAE,gBADQ;AAEZS,QAAAA,MAAM,EAAC,2BAFK;AAGZC,QAAAA,IAAI,EAAE,QAHM;AAIZ,wBAAe,aAJH;AAKZ;AACAyB,QAAAA,MAAM,EAAE;AACN,wBAAa,CAAC,KAAD,EAAO,SAAP,CADP;AAEN,uBAAa,CAAI,gBAAJ,EAAuB,0BAAvB,CAFP,CAGN;;AAHM,SANI;AAWZvB,QAAAA,KAAK,EAAC;AAAC;AACA,wBAAa,CAAC,MAAD,EAAQ,CAAC,SAAD,EAAY,CAAC,eAAD,EAAkB,OAAlB,CAAZ,EAAwC,KAAxC,CAAR,EAAuD,cAAvD,EAAsE,oBAAtE,CADd,CAEC;AACA;;AAHD;AAXM,OAAlB;AAmBA,WAAKR,GAAL,CAAS4B,EAAT,CAAY,OAAZ,EAAqB,SAArB,EAAgCR,CAAC,IAAK;AAChC;AACA,aAAK9B,QAAL,CAAc;AAACyB,UAAAA,eAAe,EAACK,CAAC,CAACY,QAAF,CAAW,CAAX,EAAcC,UAAd,CAAyBC;AAA1C,SAAd;AAEA,YAAIhB,QAAQ,GAAG,EAAf;AACA,YAAIC,OAAO,GAAE,EAAb;AACAxE,QAAAA,GAAG,CAACqD,GAAJ,CAAQoB,CAAC,IAAIA,CAAC,CAACC,KAAF,KAAU,KAAKxB,KAAL,CAAWkB,eAArB,GAAsCG,QAAQ,CAACI,IAAT,CAAcF,CAAd,CAAtC,GAAyD,IAAtE;AACAF,QAAAA,QAAQ,CAAClB,GAAT,CAAaoB,CAAC,IAAID,OAAO,CAACG,IAAR,CAAaF,CAAC,CAACzE,GAAf,CAAlB;AACA,YAAIwF,YAAY,GAAGhE,QAAQ,CAACgD,OAAD,EAAU,GAAV,CAA3B,CARgC,CAShC;;AACA7D,QAAAA,OAAO,CAACC,GAAR,CAAY2D,QAAZ;AAEA,YAAIkB,IAAI,GAACjB,OAAO,CAACvD,IAAR,CAAa,CAACC,CAAD,EAAGC,CAAH,KAASA,CAAC,GAACD,CAAxB,EAA2BwE,KAA3B,CAAiC,CAAjC,EAAmC,CAAnC,CAAT;AACAnB,QAAAA,QAAQ,CAAClB,GAAT,CAAaoB,CAAC,IAAI;AAChBA,UAAAA,CAAC,CAACkB,MAAF,GAAS1F,WAAW,CAACwE,CAAC,CAACmB,GAAH,CAAX,CAAmB,CAAnB,CAAT;AACAnB,UAAAA,CAAC,CAACoB,SAAF,GAAahE,IAAI,CAACiE,KAAL,CAAWrB,CAAC,CAACzE,GAAF,GAAMwF,YAAjB,CAAb;;AACA,cAAGf,CAAC,CAACzE,GAAF,KAAQyF,IAAI,CAAC,CAAD,CAAf,EAAoB;AAAC5E,YAAAA,SAAS,CAAC,CAAD,CAAT,GAAa4D,CAAb;AAAe,WAApC,MACK,IAAGA,CAAC,CAACzE,GAAF,KAAQyF,IAAI,CAAC,CAAD,CAAf,EAAoB;AAAC5E,YAAAA,SAAS,CAAC,CAAD,CAAT,GAAa4D,CAAb;AAAe,WAApC,MACA,IAAGA,CAAC,CAACzE,GAAF,KAAQyF,IAAI,CAAC,CAAD,CAAf,EAAoB;AAAC5E,YAAAA,SAAS,CAAC,CAAD,CAAT,GAAa4D,CAAb;AAAe,WAApC,MACA,IAAGA,CAAC,CAACzE,GAAF,KAAQyF,IAAI,CAAC,CAAD,CAAf,EAAoB;AAAC5E,YAAAA,SAAS,CAAC,CAAD,CAAT,GAAa4D,CAAb;AAAe,WAApC,MACA,IAAGA,CAAC,CAACzE,GAAF,KAAQyF,IAAI,CAAC,CAAD,CAAf,EAAoB;AAAC5E,YAAAA,SAAS,CAAC,CAAD,CAAT,GAAa4D,CAAb;AAAe;AAC1C,SARD;AASA9D,QAAAA,OAAO,CAACC,GAAR,CAAY2D,QAAZ,EAtBgC,CAuBhC;;AACA5D,QAAAA,OAAO,CAACC,GAAR,CAAY6E,IAAZ;AACA9E,QAAAA,OAAO,CAACC,GAAR,CAAYC,SAAZ,EAzBgC,CA2BlB;;AACd,cAAMkF,OAAO,GAAGxB,QAAQ,CAAClD,MAAT,CAAgB,UAAS2E,CAAT,EAAYC,CAAZ,EAAc;AAC1C,cAAG,CAACD,CAAC,CAACC,CAAC,CAACN,MAAH,CAAL,EAAgB;AACdK,YAAAA,CAAC,CAACC,CAAC,CAACN,MAAH,CAAD,GAAc,EAAC,GAAGM,CAAJ;AAAOC,cAAAA,KAAK,EAAE;AAAd,aAAd;AACA,mBAAOF,CAAP;AACD;;AACDA,UAAAA,CAAC,CAACC,CAAC,CAACN,MAAH,CAAD,CAAYE,SAAZ,IAAyBI,CAAC,CAACJ,SAA3B;AACAG,UAAAA,CAAC,CAACC,CAAC,CAACN,MAAH,CAAD,CAAYO,KAAZ,IAAqB,CAArB;AACA,iBAAOF,CAAP;AACF,SARc,EAQb,EARa,CAAhB,CA5BgC,CAsC/B;;AACGlF,QAAAA,MAAM,GAAGqF,MAAM,CAACC,IAAP,CAAYL,OAAZ,EAAqB1C,GAArB,CAAyB,UAASgD,CAAT,EAAW;AAC5C,gBAAMC,IAAI,GAAIP,OAAO,CAACM,CAAD,CAArB;AACA,iBAAO;AACHV,YAAAA,MAAM,EAAEW,IAAI,CAACX,MADV;AAEHE,YAAAA,SAAS,EAAEhE,IAAI,CAACiE,KAAL,CAAWQ,IAAI,CAACT,SAAL,GAAeS,IAAI,CAACJ,KAApB,GAA0B,GAArC,IAA0C;AAFlD,WAAP;AAIH,SANW,CAAT;AAOlBvF,QAAAA,OAAO,CAACC,GAAR,CAAYE,MAAZ,EA9C8C,CA+C7C;;AAEa,aAAK6B,QAAL,CAAc;AAAC0B,UAAAA,IAAI,EAACI,CAAC,CAACY,QAAF,CAAW,CAAX,EAAcC,UAAd,CAAyBiB;AAA/B,SAAd;AAEA,YAAIC,eAAe,GAAG,CAAC,OAAD,EAAU,CAAC,KAAD,EAAQ,YAAR,CAAV,CAAtB,CAnDgC,CAqDhC;;AACAjC,QAAAA,QAAQ,CAACkC,OAAT,CAAkBhC,CAAC,IAAI;AAEvB;AAEA;AACA,cAAGA,CAAC,CAACzE,GAAF,GAAMwF,YAAN,GAAqB,CAAxB,EAA2B;AAACgB,YAAAA,eAAe,CAAC7B,IAAhB,CAAqBF,CAAC,CAAC,KAAD,CAAtB,EAA+B,SAA/B;AAA2C,WAAvE,MACK,IAAIA,CAAC,CAACzE,GAAF,GAAMwF,YAAN,GAAqB,CAAzB,EAA4B;AAACgB,YAAAA,eAAe,CAAC7B,IAAhB,CAAqBF,CAAC,CAAC,KAAD,CAAtB,EAA+B,SAA/B;AAA2C,WAAxE,MACA,IAAIA,CAAC,CAACzE,GAAF,GAAMwF,YAAN,GAAqB,CAAzB,EAA4B;AAACgB,YAAAA,eAAe,CAAC7B,IAAhB,CAAqBF,CAAC,CAAC,KAAD,CAAtB,EAA+B,SAA/B;AAA2C,WAAxE,MACA,IAAIA,CAAC,CAACzE,GAAF,GAAMwF,YAAN,GAAqB,CAAzB,EAA4B;AAACgB,YAAAA,eAAe,CAAC7B,IAAhB,CAAqBF,CAAC,CAAC,KAAD,CAAtB,EAA+B,SAA/B;AAA2C,WAAxE,MACA,IAAIA,CAAC,CAACzE,GAAF,GAAMwF,YAAN,GAAqB,EAAzB,EAA6B;AAACgB,YAAAA,eAAe,CAAC7B,IAAhB,CAAqBF,CAAC,CAAC,KAAD,CAAtB,EAA+B,SAA/B;AAA2C,WAAzE,MACA,IAAIA,CAAC,CAACzE,GAAF,GAAMwF,YAAN,GAAqB,EAAzB,EAA6B;AAACgB,YAAAA,eAAe,CAAC7B,IAAhB,CAAqBF,CAAC,CAAC,KAAD,CAAtB,EAA+B,SAA/B;AAA2C,WAAzE,MACA,IAAIA,CAAC,CAACzE,GAAF,GAAMwF,YAAN,GAAqB,GAAzB,EAA8B;AAACgB,YAAAA,eAAe,CAAC7B,IAAhB,CAAqBF,CAAC,CAAC,KAAD,CAAtB,EAA+B,SAA/B;AAA2C,WAA1E,MACA;AAAC+B,YAAAA,eAAe,CAAC7B,IAAhB,CAAqBF,CAAC,CAAC,KAAD,CAAtB,EAA+B,SAA/B;AAA2C;AAChD,SAbD;AAeA+B,QAAAA,eAAe,CAAC7B,IAAhB,CAAqB,KAAKzB,KAAL,CAAWkB,eAAhC,EAAiD,QAAjD,EArEgC,CAuEhC;AAEA;;AACAoC,QAAAA,eAAe,CAAC7B,IAAhB,CAAqB,kBAArB,EA1EgC,CA4EhC;;AACA,aAAKxB,MAAL,CAAY,SAAZ;AACAxC,QAAAA,OAAO,CAACC,GAAR,CAAY4F,eAAZ;AACA,aAAKnD,GAAL,CAASI,QAAT,CAAkB;AAChBR,UAAAA,EAAE,EAAE,SADY;AAEhBS,UAAAA,MAAM,EAAC,qBAFS;AAGhBC,UAAAA,IAAI,EAAE,MAHU;AAIhB,0BAAe,oBAJC;AAKhB;AACAE,UAAAA,KAAK,EAAE;AACL,0BAAc2C,eADT;AAEL,4BAAgB;AAFX;AANS,SAAlB;AAYA,aAAKrD,MAAL,CAAY,gBAAZ;AACA,aAAKE,GAAL,CAASI,QAAT,CAAkB;AACZR,UAAAA,EAAE,EAAE,gBADQ;AAEZS,UAAAA,MAAM,EAAC,2BAFK;AAGZC,UAAAA,IAAI,EAAE,QAHM;AAIZ,0BAAe,aAJH;AAKZ;AACAyB,UAAAA,MAAM,EAAE;AACN,0BAAa,CAAC,KAAD,EAAO,SAAP,CADP;AAEN,yBAAa,CAAI,gBAAJ,EAAuB,0BAAvB,CAFP,CAGN;;AAHM,WANI;AAWZvB,UAAAA,KAAK,EAAC;AAAC;AACA,0BAAa,CAAC,MAAD,EAAQ,CAAC,SAAD,EAAY,CAAC,eAAD,EAAkB,OAAlB,CAAZ,EAAwC,KAAxC,CAAR,EAAuD,cAAvD,EAAsE,oBAAtE,CADd,CAEC;AACA;;AAHD;AAXM,SAAlB;AAoBD,OAhHL;AAoHR,UAAI6C,SAAS,GAAC,IAAd;AACQ,WAAKrD,GAAL,CAAS4B,EAAT,CAAY,YAAZ,EAA0B,SAA1B,EAAqCR,CAAC,IAAK;AACzC,YAAIA,CAAC,CAACY,QAAF,CAAW9D,MAAX,GAAoB,CAAxB,EAA2B;AACrB,cAAImF,SAAJ,EAAe;AACX,iBAAKrD,GAAL,CAASsD,eAAT,CACA;AAAEjD,cAAAA,MAAM,EAAE,qBAAV;AAAiCT,cAAAA,EAAE,EAACyD,SAApC;AAA+CE,cAAAA,WAAW,EAAC;AAA3D,aADA,EAEA;AAAEC,cAAAA,KAAK,EAAE;AAAT,aAFA;AAIC;;AACLH,UAAAA,SAAS,GAAGjC,CAAC,CAACY,QAAF,CAAW,CAAX,EAAcpC,EAA1B;AACA,eAAKI,GAAL,CAASsD,eAAT,CACA;AAAEjD,YAAAA,MAAM,EAAE,qBAAV;AAAiCT,YAAAA,EAAE,EAACyD,SAApC;AAA+CE,YAAAA,WAAW,EAAC;AAA3D,WADA,EAEA;AAAEC,YAAAA,KAAK,EAAE;AAAT,WAFA;AAIC;AACJ,OAdL;AAgBA,WAAKxD,GAAL,CAAS4B,EAAT,CAAY,YAAZ,EAA0B,SAA1B,EAAqCR,CAAC,IAAK;AACzC,YAAIiC,SAAJ,EAAe;AACH,eAAKrD,GAAL,CAASsD,eAAT,CACA;AAAEjD,YAAAA,MAAM,EAAE,qBAAV;AAAiCT,YAAAA,EAAE,EAACyD,SAApC;AAA+CE,YAAAA,WAAW,EAAC;AAA3D,WADA,EAEA;AAAEC,YAAAA,KAAK,EAAE;AAAT,WAFA;AAID;;AACDH,QAAAA,SAAS,GAAG,IAAZ;AACH,OART;AAaH,KA/LD;AAkMH;;AACDI,EAAAA,kBAAkB,CAACC,SAAD,EAAYC,SAAZ,EAAuB;AACrC;AAEA,QAAIA,SAAS,KAAK,KAAK9D,KAAvB,EAA8B,CAG/B;AACF;;AAoCD+D,EAAAA,MAAM,GAAG;AACL,UAAM;AAAEhD,MAAAA;AAAF,QAAqB,KAAKf,KAAhC;AACA,wBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAEhD,OAAO,CAACgH,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAmC,KAAKhE,KAAL,CAAWmB,IAA9C,oBAAoD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAApD,eACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,OACSxD,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,qCAAlB,GAA0D,IADnE,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,OAES/E,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,QAAM3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAxB,GAA2D,IAFpE,EAE0E/E,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,OAAK3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAvB,GAA0D,IAFpI,OAE2I/E,SAAS,CAAC,CAAD,CAAT,CAAagF,SAFxJ,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHF,OAGShF,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,QAAM3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAxB,GAA2D,IAHpE,EAG0E/E,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,OAAK3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAvB,GAA0D,IAHpI,QAG4I/E,SAAS,CAAC,CAAD,CAAT,CAAagF,SAHzJ,eAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,OAIShF,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,QAAM3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAxB,GAA2D,IAJpE,EAI0E/E,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,OAAK3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAvB,GAA0D,IAJpI,QAI4I/E,SAAS,CAAC,CAAD,CAAT,CAAagF,SAJzJ,eAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALF,OAKShF,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,QAAM3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAxB,GAA2D,IALpE,EAK0E/E,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,OAAK3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAvB,GAA0D,IALpI,QAK4I/E,SAAS,CAAC,CAAD,CAAT,CAAagF,SALzJ,eAME;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANF,OAMShF,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,QAAM3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAxB,GAA2D,IANpE,EAM0E/E,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAb,GAAkB,OAAK3F,WAAW,CAACY,SAAS,CAAC,CAAD,CAAT,CAAa+E,GAAd,CAAX,CAA8B,CAA9B,CAAvB,GAA0D,IANpI,QAM4I/E,SAAS,CAAC,CAAD,CAAT,CAAagF,SANzJ,EAOKlF,OAAO,CAACC,GAAR,CAAYE,MAAZ,CAPL,eAQI,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAE,GAAjB;AAAsB,MAAA,MAAM,EAAE,EAA9B;AAAkC,MAAA,IAAI,EAAEA,MAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,KAAD;AAAO,MAAA,OAAO,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAEE,oBAAC,GAAD;AAAK,MAAA,OAAO,EAAC,WAAb;AAAyB,MAAA,IAAI,EAAC,SAA9B;AAAwC,MAAA,EAAE,EAAC,QAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,eAIE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJF,CARJ,CADF,eAiBE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAiB,KAAKoC,KAAL,CAAWY,GAA5B,mBAA8C,KAAKZ,KAAL,CAAWa,GAAzD,eAAuE,KAAKb,KAAL,CAAWc,IAAlF,CAjBF,eAkBE;AAAK,MAAA,GAAG,EAAEmD,EAAE,IAAI,KAAKrC,YAAL,GAAoBqC,EAApC;AAAwC,MAAA,SAAS,EAAEjH,OAAO,CAAC4E,YAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAlBF,eAmBE;AAAK,MAAA,SAAS,EAAE5E,OAAO,CAAC+B,MAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAiCA,MAAjC,CAnBF,CADF;AAuBD;;AA/SuC;;AAiT1CrC,QAAQ,CAACqH,MAAT,eAAgB,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAhB,EAAiCG,QAAQ,CAACC,cAAT,CAAwB,KAAxB,CAAjC","sourcesContent":["import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport mapboxgl from 'mapbox-gl';\r\nimport axios from 'axios';\r\nimport Select from 'react-select';\r\nimport sci from './sci.json';\r\nimport countryData from './country.json';\r\nimport classes from './Site.module.css';\r\nimport { BarChart, Cell, Bar, Tooltip, XAxis, YAxis } from 'recharts';\r\n\r\n//iso_3166_1_alpha_3\r\n///6808: 520  baseline\r\n//// divide 20% percentile per country//////\r\n\r\n//// Access token for Africapolis mapbox account\r\nmapboxgl.accessToken = 'pk.eyJ1IjoibWttZCIsImEiOiJjajBqYjJpY2owMDE0Mndsbml0d2V1ZXczIn0.el8wQmA-TSJp2ggX8fJ1rA';\r\n\r\nconst colors = [\"#F3F2E8\",\"#D4EBE2\",\"#B6E3DB\",\"#97DCD5\",\"#79D5CF\",\"#5ACEC9\",\"#3CC6C2\",\"#1DBFBC\",\"#333333\"]\r\n\r\n\r\n\r\n//////////////////\r\n\r\n// sort array ascending\r\nconsole.log(countryData[\"AF\"])\r\nlet top5_list=[[],[],[],[],[]];\r\nlet result=[];\r\n\r\nconst asc = arr => arr.sort((a, b) => a - b);\r\n\r\nconst sum = arr => arr.reduce((a, b) => a + b, 0);\r\n\r\nconst mean = arr => sum(arr) / arr.length;\r\n\r\nconst quantile = (arr, q) => {\r\n    const sorted = asc(arr);\r\n    const pos = (sorted.length - 1) * q;\r\n    const base = Math.floor(pos);\r\n    const rest = pos - base;\r\n    if (sorted[base + 1] !== undefined) {\r\n        return sorted[base] + rest * (sorted[base + 1] - sorted[base]);\r\n    } else {\r\n        return sorted[base];\r\n    }\r\n};\r\n\r\nconst legend = (\r\n<div>\r\n  <h4>Social Connected Index</h4>\r\n<div><span style={{backgroundColor: colors[0]}}></span>{\"< 1x (20th percentile selected country)\"}</div>\r\n<div><span style={{backgroundColor: colors[1]}}></span>1-2x</div>\r\n<div><span style={{backgroundColor: colors[2]}}></span>2-3x</div>\r\n<div><span style={{backgroundColor: colors[3]}}></span>3-5x</div>\r\n<div><span style={{backgroundColor: colors[4]}}></span>5-10x</div>\r\n<div><span style={{backgroundColor: colors[5]}}></span>10-25x</div>\r\n<div><span style={{backgroundColor: colors[6]}}></span>25-100x</div>\r\n<div><span style={{backgroundColor: colors[7]}}></span>{\">= 100x\"}</div>\r\n<div><span style={{backgroundColor: colors[8]}}></span>{\"Data not available\"}</div>\r\n</div>\r\n);\r\n\r\n\r\nconst agglomeration_fill_color =[\r\n  \"step\",\r\n  [\"get\", \"Population_2015\"],\r\n  \"hsla(0, 0%, 8%, 0.5)\",\r\n  10000,\r\n  \"hsla(55, 30%, 93%, 0.5)\",\r\n  30000,\r\n  \"hsla(60, 100%, 90%, 0.5)\",\r\n  100000,\r\n  \"hsla(98, 55%, 81%, 0.5)\",\r\n  300000,\r\n  \"hsla(166, 44%, 65%, 0.5)\",\r\n  1000000,\r\n  \"hsla(186, 53%, 51%, 0.5)\",\r\n  3000000,\r\n  \"hsla(197, 74%, 43%, 0.5)\",\r\n  11847635,\r\n  \"hsla(197, 74%, 43%, 0.5)\"\r\n ]\r\n const agglomeration_stroke_color =[\r\n  \"step\",\r\n  [\"get\", \"Population_2015\"],\r\n  \"hsla(0, 0%, 8%, 1)\",\r\n  10000,\r\n  \"hsla(55, 30%, 93%, 1)\",\r\n  30000,\r\n  \"hsla(60, 100%, 90%, 1)\",\r\n  100000,\r\n  \"hsla(98, 55%, 81%, 1)\",\r\n  300000,\r\n  \"hsla(166, 44%, 65%, 1)\",\r\n  1000000,\r\n  \"hsla(186, 53%, 51%, 1)\",\r\n  3000000,\r\n  \"hsla(197, 74%, 43%, 1)\",\r\n  11847635,\r\n  \"hsla(197, 74%, 43%, 1)\"\r\n ]\r\n\r\n// const options = [];\r\n// country_label.map(v=>{return options.push({label:v, value:v})});\r\n// Values.map(v=>{return options.push({label:agglo_label[v[1]-1]+\", \"+country_label[v[0]-1], value:v})});\r\n// console.log(Values.map(v=>{return {label:agglo_label[v[1]]+\", \"+country_label[v[0]], value:v}}))\r\n\r\n\r\n\r\n//// Basic setting of the map\r\nclass Application extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      lng: 5,\r\n      lat: 0,\r\n      zoom: 2,\r\n      selectedOption: {label: 'Africa', value: ''},\r\n      selectedCountry: \"AE\",\r\n      name: \"Click the country to check SCI\",\r\n    };\r\n  }\r\ncomponentDidMount() {\r\n//// Initial map setting\r\n\r\nlet selected = [];\r\nlet scidata= [];\r\nsci.map(e => e.start===this.state.selectedCountry? selected.push(e) : null)\r\nconsole.log(selected)\r\nselected.map(e => scidata.push(e.sci))\r\nconsole.log(scidata)\r\nconsole.log(quantile(scidata, .20))\r\n//Object.keys(selected).map(e => console.log(e))\r\n\r\n\r\n\r\n     this.map = new mapboxgl.Map({\r\n      container: this.mapContainer,\r\n      style: 'mapbox://styles/mkmd/ckguwdhux0j7719p9rz2hpmpi', /// Select mapstyle from mapbox studio\r\n      center: [this.state.lng, this.state.lat],\r\n      zoom: this.state.zoom\r\n    });\r\n    // this.map.on('move', () => {\r\n    //   this.setState({\r\n    //   lng: this.map.getCenter().lng.toFixed(4),\r\n    //   lat: this.map.getCenter().lat.toFixed(4),\r\n    //   zoom: this.map.getZoom().toFixed(2)\r\n    //   });\r\n    // });\r\n//// Import Africapolis agglomerations from mapbox\r\n    this.map.on('load', () => {\r\n\r\n// Add Country shape\r\n      this.map.addSource('africapolis_country', { type: 'vector', url: 'mapbox://mapbox.country-boundaries-v1'});\r\n// Add Agglomerations\r\n  //    this.map.addSource('africapolis_agglos', { type: 'vector', url: 'mapbox://mkmd.3e0rk98j'});\r\n// Add Country label\r\n     this.map.addSource('africapolis_country_label', { type: 'vector', url: 'mapbox://mapbox.mapbox-streets-v8'});\r\n// Add Region labelled\r\n  //    this.map.addSource('africapolis_region_label', { type: 'vector', url: 'mapbox://mkmd.3yut44ue'});\r\n\r\n// Add Country layer\r\n      this.map.addLayer({\r\n            id: 'country',\r\n            source:'africapolis_country',\r\n            type: 'fill',\r\n            'source-layer':'country_boundaries',\r\n            //filter:[\"==\",\"Region_ID\",1],\r\n            paint: {\r\n\r\n              'fill-color': '#fdfdf5',\r\n              'fill-opacity': ['case',['boolean', ['feature-state', 'hover'], false],0.2,0]\r\n            }\r\n        });\r\n\r\n\r\n        this.map.addLayer({\r\n              id: 'country_labels',\r\n              source:'africapolis_country_label',\r\n              type: 'symbol',\r\n              'source-layer':'place_label',\r\n              //filter:[  \"match\",  [\"get\", \"class\"],  \"country\",  [    \"match\",    [\"get\", \"worldview\"],    [\"all\", \"US\"],    true,    false  ],  \"disputed_country\",  [    \"all\",    [      \"==\",      [\"get\", \"disputed\"],      \"true\"    ],    [      \"match\",      [\"get\", \"worldview\"],      [\"all\", \"US\"],      true,      false    ]  ],  false],\r\n              layout: {\r\n                'text-field':[\"get\",\"name_en\"],\r\n                'text-font': [   \"DIN Pro Medium\",  \"Arial Unicode MS Regular\"],\r\n                //'text-size': [\"interpolate\", [\"linear\"], [\"zoom\"], 2, [\"step\", [\"get\", \"scalerank\"], 10, 3, 8, 5, 5 ], 9, [\"step\", [\"get\", \"scalerank\"], 35, 3, 27, 5, 22 ] ],\r\n              },\r\n              paint:{//'text-opacity':[ \"step\",[\"zoom\"],  0,  3,  1,  22,  1],\r\n                     'text-color':['case',['boolean', ['feature-state', 'hover'], false],\"hsl(0,0%,0%)\",\"hsl(215, 30%, 75%)\"],\r\n                     //'text-halo-color': \"hsl(0, 0%, 100%)\",\r\n                     //'text-halo-width': 1.25\r\n                   }\r\n          });\r\n\r\n\r\n        this.map.on('click', 'country', e =>  {\r\n              //console.log(e.features[0].properties.iso_3166_1)\r\n              this.setState({selectedCountry:e.features[0].properties.iso_3166_1})\r\n\r\n              let selected = [];\r\n              let scidata= [];\r\n              sci.map(e => e.start===this.state.selectedCountry? selected.push(e) : null)\r\n              selected.map(e => scidata.push(e.sci))\r\n              let percentile20 = quantile(scidata, .20)\r\n              //selected.map(e => e.sci = e.sci/ percentile20)\r\n              console.log(selected)\r\n\r\n              let top5=scidata.sort((a,b) => b-a).slice(0,5);\r\n              selected.map(e => {\r\n                e.region=countryData[e.end][1]\r\n                e.sciScaled= Math.round(e.sci/percentile20)\r\n                if(e.sci===top5[0]) {top5_list[0]=e}\r\n                else if(e.sci===top5[1]) {top5_list[1]=e}\r\n                else if(e.sci===top5[2]) {top5_list[2]=e}\r\n                else if(e.sci===top5[3]) {top5_list[3]=e}\r\n                else if(e.sci===top5[4]) {top5_list[4]=e}\r\n              })\r\n              console.log(selected)\r\n              //top5_list.map(e => e.sciScaled= Math.round(e.sci/percentile20))\r\n              console.log(top5)\r\n              console.log(top5_list)\r\n\r\n                            // Calculate the sums and group data (while tracking count)\r\n              const reduced = selected.reduce(function(m, d){\r\n                  if(!m[d.region]){\r\n                    m[d.region] = {...d, count: 1};\r\n                    return m;\r\n                  }\r\n                  m[d.region].sciScaled += d.sciScaled;\r\n                  m[d.region].count += 1;\r\n                  return m;\r\n               },{});\r\n\r\n               // Create new array from grouped data and compute the average\r\n                  result = Object.keys(reduced).map(function(k){\r\n                   const item  = reduced[k];\r\n                   return {\r\n                       region: item.region,\r\n                       sciScaled: Math.round(item.sciScaled/item.count*100)/100,\r\n                   }\r\n               })\r\nconsole.log(result)\r\n // console.log(JSON.stringify(result,null,4));\r\n\r\n              this.setState({name:e.features[0].properties.name_en})\r\n\r\n              let matchExpression = ['match', ['get', 'iso_3166_1']];\r\n\r\n              // Calculate color values for each country based on 'hdi' value\r\n              selected.forEach( e => {\r\n\r\n              // 1 2 3 5 10 25 100 above100\r\n\r\n              //e.sci = e.sci/percentile20\r\n              if(e.sci/percentile20 < 1) {matchExpression.push(e['end'], \"#F3F2E8\");}\r\n              else if (e.sci/percentile20 < 2) {matchExpression.push(e['end'], \"#D4EBE2\");}\r\n              else if (e.sci/percentile20 < 3) {matchExpression.push(e['end'], \"#B6E3DB\");}\r\n              else if (e.sci/percentile20 < 5) {matchExpression.push(e['end'], \"#97DCD5\");}\r\n              else if (e.sci/percentile20 < 10) {matchExpression.push(e['end'], \"#79D5CF\");}\r\n              else if (e.sci/percentile20 < 25) {matchExpression.push(e['end'], \"#5ACEC9\");}\r\n              else if (e.sci/percentile20 < 100) {matchExpression.push(e['end'], \"#3CC6C2\");}\r\n              else {matchExpression.push(e['end'], \"#1DBFBC\");}\r\n              });\r\n\r\n              matchExpression.push(this.state.selectedCountry, 'yellow');\r\n\r\n              //console.log(matchExpression)\r\n\r\n              // Last value is the default, used where there is no data\r\n              matchExpression.push('rgba(0, 0, 0, 0)');\r\n\r\n              // //console.log(this.state.selectedOption, prevState.selectedOption);\r\n              this.remove('country');\r\n              console.log(matchExpression)\r\n              this.map.addLayer({\r\n                id: 'country',\r\n                source:'africapolis_country',\r\n                type: 'fill',\r\n                'source-layer':'country_boundaries',\r\n                //filter:[\"==\",\"Region_ID\",1],\r\n                paint: {\r\n                  'fill-color': matchExpression,\r\n                  'fill-opacity': 0.9\r\n                }\r\n              });\r\n\r\n              this.remove('country_labels')\r\n              this.map.addLayer({\r\n                    id: 'country_labels',\r\n                    source:'africapolis_country_label',\r\n                    type: 'symbol',\r\n                    'source-layer':'place_label',\r\n                    //filter:[  \"match\",  [\"get\", \"class\"],  \"country\",  [    \"match\",    [\"get\", \"worldview\"],    [\"all\", \"US\"],    true,    false  ],  \"disputed_country\",  [    \"all\",    [      \"==\",      [\"get\", \"disputed\"],      \"true\"    ],    [      \"match\",      [\"get\", \"worldview\"],      [\"all\", \"US\"],      true,      false    ]  ],  false],\r\n                    layout: {\r\n                      'text-field':[\"get\",\"name_en\"],\r\n                      'text-font': [   \"DIN Pro Medium\",  \"Arial Unicode MS Regular\"],\r\n                      //'text-size': [\"interpolate\", [\"linear\"], [\"zoom\"], 2, [\"step\", [\"get\", \"scalerank\"], 10, 3, 8, 5, 5 ], 9, [\"step\", [\"get\", \"scalerank\"], 35, 3, 27, 5, 22 ] ],\r\n                    },\r\n                    paint:{//'text-opacity':[ \"step\",[\"zoom\"],  0,  3,  1,  22,  1],\r\n                           'text-color':['case',['boolean', ['feature-state', 'hover'], false],\"hsl(0,0%,0%)\",\"hsl(215, 30%, 75%)\"],\r\n                           //'text-halo-color': \"hsl(0, 0%, 100%)\",\r\n                           //'text-halo-width': 1.25\r\n                         }\r\n                });\r\n\r\n\r\n\r\n            });\r\n\r\n\r\n\r\nvar hoveredID=null;\r\n        this.map.on('mouseenter', 'country', e =>  {\r\n          if (e.features.length > 0) {\r\n                if (hoveredID) {\r\n                    this.map.setFeatureState(\r\n                    { source: 'africapolis_country', id:hoveredID, sourceLayer:'country_boundaries' },\r\n                    { hover: false }\r\n                    );\r\n                    }\r\n                hoveredID = e.features[0].id;\r\n                this.map.setFeatureState(\r\n                { source: 'africapolis_country', id:hoveredID, sourceLayer:'country_boundaries' },\r\n                { hover: true }\r\n                );\r\n                }\r\n            });\r\n\r\n        this.map.on('mouseleave', 'country', e =>  {\r\n          if (hoveredID) {\r\n                      this.map.setFeatureState(\r\n                      { source: 'africapolis_country', id:hoveredID, sourceLayer:'country_boundaries' },\r\n                      { hover: false }\r\n                      );\r\n                    }\r\n                    hoveredID = null;\r\n                });\r\n\r\n\r\n\r\n\r\n    });\r\n\r\n\r\n}\r\ncomponentDidUpdate(prevProps, prevState) {\r\n    //if( prevState.selectedOption !== this.state.selectedOption || prevState.update[0] !== this.state.update[0]) {\r\n\r\n    if( prevState !== this.state) {\r\n\r\n\r\n  }\r\n}\r\n\r\nonUpdate = update => {\r\n  this.setState({ update })\r\n}\r\n\r\nonChange = values => {\r\n  this.setState({ values })\r\n}\r\n\r\nonFilter = filters => {\r\n  this.setState({[filters.target.id]: !this.state[filters.target.id]});\r\n}\r\n\r\nremove = obj => {\r\n    this.map.removeLayer(obj)\r\n}\r\n\r\nadd_shape = (obj,filter1) => {\r\n    this.map.addLayer({\r\n        id: obj,\r\n        source:'africapolis_country',\r\n        type: 'fill',\r\n        'source-layer':'africacontinent_complete-ays128',\r\n        filter:filter1,\r\n        paint: {\r\n          'fill-color': '#fdfdf5',\r\n          'fill-opacity': [\"interpolate\",[\"linear\"],[\"zoom\"], 0,1,5,0] //8.5\r\n        }\r\n    }\r\n   // layer order\r\n  );\r\n    //console.log(this.map.getSource(\"africapolis_country\"))\r\n\r\n}\r\n\r\nrender() {\r\n    const { selectedOption } = this.state;\r\n    return (\r\n      <div>\r\n        <div className={classes.topleft}> {this.state.name} <br/>\r\n          <br/> {top5_list[0].end? \"Five countries with the highest SCI\" : null}\r\n          <br/> {top5_list[0].end? \"1. \"+countryData[top5_list[0].end][0] : null}{top5_list[0].end? \", \"+countryData[top5_list[0].end][1] : null} {top5_list[0].sciScaled}\r\n          <br/> {top5_list[1].end? \"2. \"+countryData[top5_list[1].end][0] : null}{top5_list[1].end? \", \"+countryData[top5_list[1].end][1] : null}  {top5_list[1].sciScaled}\r\n          <br/> {top5_list[2].end? \"3. \"+countryData[top5_list[2].end][0] : null}{top5_list[2].end? \", \"+countryData[top5_list[2].end][1] : null}  {top5_list[2].sciScaled}\r\n          <br/> {top5_list[3].end? \"4. \"+countryData[top5_list[3].end][0] : null}{top5_list[3].end? \", \"+countryData[top5_list[3].end][1] : null}  {top5_list[3].sciScaled}\r\n          <br/> {top5_list[4].end? \"5. \"+countryData[top5_list[4].end][0] : null}{top5_list[4].end? \", \"+countryData[top5_list[4].end][1] : null}  {top5_list[4].sciScaled}\r\n            {console.log(result)}\r\n            <BarChart width={380} height={65} data={result}>\r\n              <XAxis dataKey=\"region\"/>\r\n              <Bar dataKey=\"sciScaled\" fill=\"#8884d8\" id=\"region\">\r\n  \t\t\t\t\t\t</Bar>\r\n              <Tooltip/>\r\n  \t\t\t\t\t</BarChart>\r\n\r\n           </div>\r\n        <div>Longitude: {this.state.lng} | Latitude: {this.state.lat} | Zoom: {this.state.zoom}</div>\r\n        <div ref={el => this.mapContainer = el} className={classes.mapContainer} />\r\n        <div className={classes.legend}>{legend}</div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\nReactDOM.render(<Application />, document.getElementById('app'));\r\n"]},"metadata":{},"sourceType":"module"}