{"ast":null,"code":"import _objectSpread from\"C:\\\\mapboxAndReact\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:\\\\mapboxAndReact\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\mapboxAndReact\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _createSuper from\"C:\\\\mapboxAndReact\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _inherits from\"C:\\\\mapboxAndReact\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import ReactDOM from'react-dom';import mapboxgl from'mapbox-gl';import sciOriginal from'./sci.json';import countryData from'./country.json';import classes from'./Site.module.css';import{BarChart,Cell,Bar,Tooltip,XAxis}from'recharts';import ReactGA from'react-ga';import'./index.css';import logo from'./OECD_white_EN.png';import MaterialIcon from'material-icons-react';ReactGA.initialize('UA-128268752-1');ReactGA.pageview(window.location.search+window.location.pathname);//iso_3166_1_alpha_3\n//// Access token for Africapolis mapbox account\nmapboxgl.accessToken='pk.eyJ1IjoibWttZCIsImEiOiJjajBqYjJpY2owMDE0Mndsbml0d2V1ZXczIn0.el8wQmA-TSJp2ggX8fJ1rA';var colors=[\"#F3F2E8\",\"#D4EBE2\",\"#B6E3DB\",\"#97DCD5\",\"#79D5CF\",\"#5ACEC9\",\"#3CC6C2\",\"#1DBFBC\",\"#333333\"];//////////////////\n// sort array ascending\nvar top5_list=[[],[],[],[],[]];var result=[];var regionTotal={Africa:55,Americas:40,Asia:46,Europe:42,Oceania:12};var asc=function asc(arr){return arr.sort(function(a,b){return a-b;});};var quantile=function quantile(arr,q){var sorted=asc(arr);var pos=(sorted.length-1)*q;var base=Math.floor(pos);var rest=pos-base;if(sorted[base+1]!==undefined){return sorted[base]+rest*(sorted[base+1]-sorted[base]);}else{return sorted[base];}};var legend=/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h4\",null,\"Social Connectedness\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:colors[0]}}),\"< 1x\",\" \",/*#__PURE__*/React.createElement(\"small\",null,\"(20th percentile)\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:colors[1]}}),\"1-2x\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:colors[2]}}),\"2-3x\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:colors[3]}}),\"3-5x\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:colors[4]}}),\"5-10x\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:colors[5]}}),\"10-25x\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:colors[6]}}),\"25-100x\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:colors[7]}}),\">= 100x\"),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"span\",{style:{backgroundColor:colors[8]}}),\"Data not available\"));var tooltip=function tooltip(e){if(e.payload[0]){return/*#__PURE__*/React.createElement(\"div\",{className:classes.tooltip},\" \",e.payload[0].payload.region,\" \",/*#__PURE__*/React.createElement(\"br\",null),\"SCI \",e.payload[0].payload.sciScaled,\"x\");}};//// Basic setting of the map\nvar Application=/*#__PURE__*/function(_React$Component){_inherits(Application,_React$Component);var _super=_createSuper(Application);function Application(props){var _this;_classCallCheck(this,Application);_this=_super.call(this,props);_this.onUpdate=function(ISO2,Name,Region){_this.setState({selectedCountry:ISO2});var sci=[];sciOriginal.map(function(e){return _this.state.button===\"From\"?sci.push({start:e.start,end:e.end,sci:e.sci}):sci.push({end:e.start,start:e.end,sci:e.sci});});var selected=[];var scidata=[];var scidataRank=[];var scidataRankRegion={Africa:[],Americas:[],Asia:[],Europe:[],Oceania:[]};var scidataRankRegionCode={Africa:[],Americas:[],Asia:[],Europe:[],Oceania:[]};sci.map(function(e){return e.start===_this.state.selectedCountry?selected.push(e):null;});selected.map(function(e){scidata.push(e.sci);scidataRank.push(e.sci);scidataRankRegion[countryData[e.end][1]].push(e.sci);scidataRankRegionCode[countryData[e.end][1]].push(e.end);});Object.keys(scidataRankRegion).map(function(k){var sorted=scidataRankRegion[k].slice().sort(function(a,b){return b-a;});var rank_region=scidataRankRegion[k].map(function(v){return sorted.indexOf(v)+1;});scidataRankRegion[k]=rank_region;});var percentile20=quantile(scidata,.20);//selected.map(e => e.sci = e.sci/ percentile20)\nvar sortedSCI=scidata.sort(function(a,b){return b-a;});var rank_country=scidataRank.map(function(v){return sortedSCI.indexOf(v)+1;});var top5=scidata.sort(function(a,b){return b-a;}).slice(0,5);selected.map(function(e){e.region=countryData[e.end][1];e.sciScaled=Math.round(e.sci/percentile20);if(e.sci===top5[0]){top5_list[0]=e;}else if(e.sci===top5[1]){top5_list[1]=e;}else if(e.sci===top5[2]){top5_list[2]=e;}else if(e.sci===top5[3]){top5_list[3]=e;}else if(e.sci===top5[4]){top5_list[4]=e;}});//top5_list.map(e => e.sciScaled= Math.round(e.sci/percentile20))\n// Calculate the sums and group data (while tracking count)\nvar reduced=selected.reduce(function(m,d){if(!m[d.region]){m[d.region]=_objectSpread({},d,{count:1});return m;}m[d.region].sciScaled+=d.sciScaled;m[d.region].count+=1;return m;},{});// Create new array from grouped data and compute the average\nresult=Object.keys(reduced).map(function(k){var item=reduced[k];return{region:item.region,sciScaled:Math.round(item.sciScaled/item.count*100)/100,numbers:item.count};});// console.log(JSON.stringify(result,null,4));\n_this.setState({name:Name,region:Region});var matchExpression=['match',['get','iso_3166_1']];// Calculate color values for each country based on 'hdi' value\nselected.forEach(function(e){if(e.sci/percentile20<1){matchExpression.push(e['end'],\"#F3F2E8\");}else if(e.sci/percentile20<2){matchExpression.push(e['end'],\"#D4EBE2\");}else if(e.sci/percentile20<3){matchExpression.push(e['end'],\"#B6E3DB\");}else if(e.sci/percentile20<5){matchExpression.push(e['end'],\"#97DCD5\");}else if(e.sci/percentile20<10){matchExpression.push(e['end'],\"#79D5CF\");}else if(e.sci/percentile20<25){matchExpression.push(e['end'],\"#5ACEC9\");}else if(e.sci/percentile20<100){matchExpression.push(e['end'],\"#3CC6C2\");}else{matchExpression.push(e['end'],\"#1DBFBC\");}});matchExpression.push(_this.state.selectedCountry,'#e8ae40');// Last value is the default, used where there is no data\nmatchExpression.push('rgba(0, 0, 0, 0)');// //console.log(this.state.selectedOption, prevState.selectedOption);\n_this.remove('country');_this.map.addLayer({id:'country',source:'africapolis_country',type:'fill',filter:[\"match\",[\"get\",\"iso_3166_1\"],[\"IR\",\"CN\",\"GL\",\"SJ\",\"TM\",\"EH\",\"KP\",\"TJ\"],false,true],'source-layer':'country_boundaries',paint:{'fill-color':matchExpression,'fill-opacity':0.9}});_this.map.on('mousemove','country',function(e){if(_this.state.selectedCountry!==e.features[0].properties.iso_3166_1){_this.map.getCanvas().style.cursor='pointer';var coordinates=[e.lngLat.lng,e.lngLat.lat];var sciPopup=[];var rankPopup=[];var sciColor=[];var rankPopupRegion=[];var regionNumber=regionTotal[e.features[0].properties.region];selected.forEach(function(d,i){if(d.end===e.features[0].properties.iso_3166_1){sciPopup=Math.round(d.sci/percentile20);rankPopup=rank_country[i];if(d.sci/percentile20<1){sciColor.push(\"#F3F2E8\");}else if(d.sci/percentile20<2){sciColor.push(\"#D4EBE2\");}else if(d.sci/percentile20<3){sciColor.push(\"#B6E3DB\");}else if(d.sci/percentile20<5){sciColor.push(\"#97DCD5\");}else if(d.sci/percentile20<10){sciColor.push(\"#79D5CF\");}else if(d.sci/percentile20<25){sciColor.push(\"#5ACEC9\");}else if(d.sci/percentile20<100){sciColor.push(\"#3CC6C2\");}else{sciColor.push(\"#1DBFBC\");}}});if(scidataRankRegionCode[e.features[0].properties.region]){scidataRankRegionCode[e.features[0].properties.region].map(function(d,i){return e.features[0].properties.iso_3166_1===d?rankPopupRegion.push(scidataRankRegion[e.features[0].properties.region][i]):null;});}_this.popUp.setLngLat(coordinates).setHTML(\"<strong>\".concat(e.features[0].properties.name_en,\"</strong> \").concat(sciPopup,\"<little>x</little><br/>\\n                <span>Rank:</span><bold>\").concat(rankPopup,\"</bold><span>/194</span><br/>\\n                  <small>In \").concat(e.features[0].properties.region,\":</small><bold>\").concat(rankPopupRegion,\"</bold><span>/\").concat(regionNumber,\"</span>\")).addTo(_this.map);var popupElem=_this.popUp.getElement();popupElem.style.color=sciColor[0];}else{_this.popUp.remove();}});_this.setState({rendered:\"Yes\"});};_this.remove=function(obj){_this.map.removeLayer(obj);};_this.moveRegion=function(e){if(e){switch(e.activeLabel){case'Africa':_this.map.flyTo({center:[32.259,2.036],zoom:3.14,essential:true});break;case'Americas':_this.map.flyTo({center:[-69.390,22.259],zoom:1.82,essential:true});break;case'Asia':_this.map.flyTo({center:[104.687,32.592],zoom:3.14,essential:true});break;case'Europe':_this.map.flyTo({center:[27.920,56.907],zoom:3.19,essential:true});break;case'Oceania':_this.map.flyTo({center:[155.731,-16.435],zoom:3.11,essential:true});break;default:return null;}}};_this.state={lng:40,lat:30,zoom:2,selectedCountry:\"NG\",name:\"\",region:\"Africa\",button:\"From\",rendered:\"\"};return _this;}_createClass(Application,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;//// Initial map setting\nvar sci=[];sciOriginal.map(function(e){return _this2.state.button===\"From\"?sci.push({start:e.start,end:e.end,sci:e.sci}):sci.push({end:e.start,start:e.end,sci:e.sci});});var selected=[];var scidata=[];var scidataRank=[];var scidataRankRegion={Africa:[],Americas:[],Asia:[],Europe:[],Oceania:[]};var scidataRankRegionCode={Africa:[],Americas:[],Asia:[],Europe:[],Oceania:[]};sci.map(function(e){return e.start===_this2.state.selectedCountry?selected.push(e):null;});selected.map(function(e){scidata.push(e.sci);scidataRank.push(e.sci);scidataRankRegion[countryData[e.end][1]].push(e.sci);scidataRankRegionCode[countryData[e.end][1]].push(e.end);});Object.keys(scidataRankRegion).map(function(k){var sorted=scidataRankRegion[k].slice().sort(function(a,b){return b-a;});var rank_region=scidataRankRegion[k].map(function(v){return sorted.indexOf(v)+1;});scidataRankRegion[k]=rank_region;});this.popUp=new mapboxgl.Popup({closeButton:false,closeOnClick:false});this.map=new mapboxgl.Map({container:this.mapContainer,style:'mapbox://styles/mkmd/ckguwdhux0j7719p9rz2hpmpi',/// Select mapstyle from mapbox studio\ncenter:[this.state.lng,this.state.lat],zoom:this.state.zoom,attributionControl:false});var top5=scidata.sort(function(a,b){return b-a;}).slice(0,5);var sortedSCI=scidata.sort(function(a,b){return b-a;});var rank_country=scidataRank.map(function(v){return sortedSCI.indexOf(v)+1;});var percentile20=quantile(scidata,.20);selected.map(function(e){e.region=countryData[e.end][1];e.sciScaled=Math.round(e.sci/percentile20);if(e.sci===top5[0]){top5_list[0]=e;}else if(e.sci===top5[1]){top5_list[1]=e;}else if(e.sci===top5[2]){top5_list[2]=e;}else if(e.sci===top5[3]){top5_list[3]=e;}else if(e.sci===top5[4]){top5_list[4]=e;}});// Calculate the sums and group data (while tracking count)\nvar reduced=selected.reduce(function(m,d){if(!m[d.region]){m[d.region]=_objectSpread({},d,{count:1});return m;}m[d.region].sciScaled+=d.sciScaled;m[d.region].count+=1;return m;},{});// Create new array from grouped data and compute the average\nresult=Object.keys(reduced).map(function(k){var item=reduced[k];return{region:item.region,sciScaled:Math.round(item.sciScaled/item.count*100)/100};});var matchExpression=['match',['get','iso_3166_1']];// Calculate color values for each country based on 'hdi' value\nselected.forEach(function(e){if(e.sci/percentile20<1){matchExpression.push(e['end'],\"#F3F2E8\");}else if(e.sci/percentile20<2){matchExpression.push(e['end'],\"#D4EBE2\");}else if(e.sci/percentile20<3){matchExpression.push(e['end'],\"#B6E3DB\");}else if(e.sci/percentile20<5){matchExpression.push(e['end'],\"#97DCD5\");}else if(e.sci/percentile20<10){matchExpression.push(e['end'],\"#79D5CF\");}else if(e.sci/percentile20<25){matchExpression.push(e['end'],\"#5ACEC9\");}else if(e.sci/percentile20<100){matchExpression.push(e['end'],\"#3CC6C2\");}else{matchExpression.push(e['end'],\"#1DBFBC\");}});matchExpression.push(this.state.selectedCountry,'#e8ae40');// Last value is the default, used where there is no data\nmatchExpression.push('rgba(0, 0, 0, 0)');// //console.log(this.state.selectedOption, prevState.selectedOption);\nthis.map.on('load',function(){_this2.map.addControl(new mapboxgl.AttributionControl({customAttribution:\"Africapolis\"}));// Add Country shape\n_this2.map.addSource('africapolis_country',{type:'vector',url:'mapbox://mapbox.country-boundaries-v1'});// Add Country layer\n_this2.map.addLayer({id:'country',source:'africapolis_country',type:'fill','source-layer':'country_boundaries',filter:[\"match\",[\"get\",\"iso_3166_1\"],[\"TJ\",\"IR\",\"CN\",\"GL\",\"SJ\",\"TM\",\"EH\",\"KP\"],false,true],paint:{'fill-color':matchExpression,'fill-opacity':0.9}});_this2.map.on('click','country',function(e){_this2.popUp.remove();_this2.onUpdate(e.features[0].properties.iso_3166_1,e.features[0].properties.name_en,e.features[0].properties.region);});_this2.map.on('mousemove','country',function(e){if(_this2.state.selectedCountry!==e.features[0].properties.iso_3166_1){_this2.map.getCanvas().style.cursor='pointer';var coordinates=[e.lngLat.lng,e.lngLat.lat];var sciPopup=[];var rankPopup=[];var sciColor=[];var rankPopupRegion=[];var regionNumber=regionTotal[e.features[0].properties.region];selected.forEach(function(d,i){if(d.end===e.features[0].properties.iso_3166_1){sciPopup=Math.round(d.sci/percentile20);rankPopup=rank_country[i];if(d.sci/percentile20<1){sciColor.push(\"#F3F2E8\");}else if(d.sci/percentile20<2){sciColor.push(\"#D4EBE2\");}else if(d.sci/percentile20<3){sciColor.push(\"#B6E3DB\");}else if(d.sci/percentile20<5){sciColor.push(\"#97DCD5\");}else if(d.sci/percentile20<10){sciColor.push(\"#79D5CF\");}else if(d.sci/percentile20<25){sciColor.push(\"#5ACEC9\");}else if(d.sci/percentile20<100){sciColor.push(\"#3CC6C2\");}else{sciColor.push(\"#1DBFBC\");}}});if(scidataRankRegionCode[e.features[0].properties.region]){scidataRankRegionCode[e.features[0].properties.region].map(function(d,i){return e.features[0].properties.iso_3166_1===d?rankPopupRegion.push(scidataRankRegion[e.features[0].properties.region][i]):null;});}_this2.popUp.setLngLat(coordinates).setHTML(\"<strong>\".concat(e.features[0].properties.name_en,\"</strong> \").concat(sciPopup,\"<little>x</little><br/>\\n                              <span>Rank:</span><bold>\").concat(rankPopup,\"</bold><span>/194</span><br/>\\n                                <small>In \").concat(e.features[0].properties.region,\":</small><bold>\").concat(rankPopupRegion,\"</bold><span>/\").concat(regionNumber,\"</span>\")).addTo(_this2.map);var popupElem=_this2.popUp.getElement();popupElem.style.color=sciColor[0];}else{_this2.popUp.remove();}});_this2.map.on('mouseleave','country',function(e){_this2.map.getCanvas().style.cursor='';_this2.popUp.remove();});});this.setState({name:\"Nigeria\"});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){if(prevState.button!==this.state.button){this.onUpdate(this.state.selectedCountry,this.state.name,this.state.region);}}},{key:\"render\",//5 Countries with the highest SCI\nvalue:function render(){var _this3=this;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:classes.topleft},\" \",/*#__PURE__*/React.createElement(\"div\",{className:classes.headwrapper},\" \",/*#__PURE__*/React.createElement(\"div\",{className:classes.buttonwrapper},/*#__PURE__*/React.createElement(\"button\",{className:this.state.button===\"From\"?classes.buttonActive:classes.button,onClick:function onClick(){return _this3.state.button===\"To\"?_this3.setState({button:\"From\"}):null;}},\"From\"),/*#__PURE__*/React.createElement(\"button\",{className:this.state.button===\"To\"?classes.buttonActive:classes.button,onClick:function onClick(){return _this3.state.button===\"From\"?_this3.setState({button:\"To\"}):null;}},\"To\")),/*#__PURE__*/React.createElement(\"headtitle\",null,\" \",this.state.name)),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"span\",null,\"5 Most Connected Countries\"),/*#__PURE__*/React.createElement(\"table\",{className:classes.table},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Country\"),/*#__PURE__*/React.createElement(\"th\",null,\"SCI\"),/*#__PURE__*/React.createElement(\"th\",null,\"Region\"))),/*#__PURE__*/React.createElement(\"tbody\",null,top5_list[0].end?top5_list.map(function(e,i){return/*#__PURE__*/React.createElement(\"tr\",null,\" \",/*#__PURE__*/React.createElement(\"td\",null,countryData[top5_list[i].end][0]),\" \",/*#__PURE__*/React.createElement(\"td\",null,top5_list[i].sciScaled,\"x\"),/*#__PURE__*/React.createElement(\"td\",{className:countryData[top5_list[i].end][1]===_this3.state.region?classes.regionsel:classes.normal},countryData[top5_list[i].end][1]));}):null)),/*#__PURE__*/React.createElement(\"br\",null),\" \",/*#__PURE__*/React.createElement(\"span\",null,\"Regional average\"),/*#__PURE__*/React.createElement(BarChart,{width:320,height:150,data:result.sort(function(a,b){return a.region.localeCompare(b.region);}),style:{marginTop:\"10px\"},onClick:function onClick(e){return _this3.moveRegion(e);}},/*#__PURE__*/React.createElement(XAxis,{dataKey:\"region\",style:{textAnchor:'middle',fontSize:'100%',fill:'rgba(255, 255, 255, 1)'}}),/*#__PURE__*/React.createElement(Tooltip,{content:tooltip,cursor:{fill:'rgba(255, 255, 255, 0.3)'}}),/*#__PURE__*/React.createElement(Bar,{dataKey:\"sciScaled\",fill:\"#3CC6C2\",id:\"region\"},result.map(function(entry,index){return/*#__PURE__*/React.createElement(Cell,{cursor:\"pointer\",key:\"cell-\".concat(index),fill:entry.region===_this3.state.region?'#e8ae40':'#3CC6C2'});}))),/*#__PURE__*/React.createElement(\"div\",{className:\"VariableInfoWrapper\"},/*#__PURE__*/React.createElement(\"a\",{href:\"https://dataforgood.fb.com/tools/social-connectedness-index/#:~:text=The%20Social%20Connectedness%20Index%20measures,social%20mobility%2C%20trade%20and%20more.\"},/*#__PURE__*/React.createElement(MaterialIcon,{icon:\"info\"})),/*#__PURE__*/React.createElement(\"span\",null,/*#__PURE__*/React.createElement(\"strong\",null,\"What is the Social Connectedness Index?\"),/*#__PURE__*/React.createElement(\"br\",null),\"The Social Connectedness Index measures the strength of connectedness between two geographic areas as represented by Facebook friendship ties.\",/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"strong\",null,\"Methodology\"),/*#__PURE__*/React.createElement(\"br\",null),\"We use aggregated friendship connections on Facebook to measure social connectedness between geographies. Locations are assigned to users based on information they provide, connection information, and location services they have opted into. We use these friendships to estimate the probability a pair of users in these countries are Facebook friends and map this to an index score called the Social Connectedness Index (SCI). If the SCI is twice as large between two pairs of regions, it means the users in the first region-pair are about twice as likely to be connected than the second region-pair.\",/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),\"The figure shows a heat map of the social connectedness. For each country in our data, the colors highlight connections of the focal country, given in orange. The lightest color corresponds to the 20th percentile of the connectedness to the focal country; darker colors correspond to closer connections.\",/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"color\",null,\"Click this button to check more detail and download the data on the Facebook page\"),\" \"))),/*#__PURE__*/React.createElement(\"div\",{ref:function ref(el){return _this3.mapContainer=el;},className:classes.mapContainer}),/*#__PURE__*/React.createElement(\"div\",{className:classes.legend},legend),/*#__PURE__*/React.createElement(\"a\",{href:\"https://africapolis.org\"},/*#__PURE__*/React.createElement(\"img\",{className:classes.logo,src:logo,alt:\"Africapolis\"})));}}]);return Application;}(React.Component);ReactDOM.render(/*#__PURE__*/React.createElement(Application,null),document.getElementById('app'));","map":{"version":3,"sources":["C:/mapboxAndReact/src/index.js"],"names":["React","ReactDOM","mapboxgl","sciOriginal","countryData","classes","BarChart","Cell","Bar","Tooltip","XAxis","ReactGA","logo","MaterialIcon","initialize","pageview","window","location","search","pathname","accessToken","colors","top5_list","result","regionTotal","Africa","Americas","Asia","Europe","Oceania","asc","arr","sort","a","b","quantile","q","sorted","pos","length","base","Math","floor","rest","undefined","legend","backgroundColor","tooltip","e","payload","region","sciScaled","Application","props","onUpdate","ISO2","Name","Region","setState","selectedCountry","sci","map","state","button","push","start","end","selected","scidata","scidataRank","scidataRankRegion","scidataRankRegionCode","Object","keys","k","slice","rank_region","v","indexOf","percentile20","sortedSCI","rank_country","top5","round","reduced","reduce","m","d","count","item","numbers","name","matchExpression","forEach","remove","addLayer","id","source","type","filter","paint","on","features","properties","iso_3166_1","getCanvas","style","cursor","coordinates","lngLat","lng","lat","sciPopup","rankPopup","sciColor","rankPopupRegion","regionNumber","i","popUp","setLngLat","setHTML","name_en","addTo","popupElem","getElement","color","rendered","obj","removeLayer","moveRegion","activeLabel","flyTo","center","zoom","essential","Popup","closeButton","closeOnClick","Map","container","mapContainer","attributionControl","addControl","AttributionControl","customAttribution","addSource","url","prevProps","prevState","topleft","headwrapper","buttonwrapper","buttonActive","table","regionsel","normal","localeCompare","marginTop","textAnchor","fontSize","fill","entry","index","el","Component","render","document","getElementById"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport mapboxgl from 'mapbox-gl';\r\nimport sciOriginal from './sci.json';\r\nimport countryData from './country.json';\r\nimport classes from './Site.module.css';\r\nimport { BarChart, Cell, Bar, Tooltip, XAxis} from 'recharts';\r\nimport ReactGA from 'react-ga';\r\nimport './index.css';\r\nimport logo from './OECD_white_EN.png';\r\nimport MaterialIcon from 'material-icons-react';\r\n\r\n\r\nReactGA.initialize('UA-128268752-1');\r\nReactGA.pageview(window.location.search+window.location.pathname);\r\n\r\n//iso_3166_1_alpha_3\r\n\r\n//// Access token for Africapolis mapbox account\r\nmapboxgl.accessToken = 'pk.eyJ1IjoibWttZCIsImEiOiJjajBqYjJpY2owMDE0Mndsbml0d2V1ZXczIn0.el8wQmA-TSJp2ggX8fJ1rA';\r\n\r\n\r\nconst colors = [\"#F3F2E8\",\"#D4EBE2\",\"#B6E3DB\",\"#97DCD5\",\"#79D5CF\",\"#5ACEC9\",\"#3CC6C2\",\"#1DBFBC\",\"#333333\"]\r\n\r\n\r\n\r\n//////////////////\r\n\r\n// sort array ascending\r\nlet top5_list=[[],[],[],[],[]];\r\nlet result=[];\r\n\r\n\r\n\r\nconst regionTotal={Africa:55,Americas:40,Asia:46,Europe:42,Oceania:12}\r\n\r\nconst asc = arr => arr.sort((a, b) => a - b);\r\n\r\nconst quantile = (arr, q) => {\r\n    const sorted = asc(arr);\r\n    const pos = (sorted.length - 1) * q;\r\n    const base = Math.floor(pos);\r\n    const rest = pos - base;\r\n    if (sorted[base + 1] !== undefined) {\r\n        return sorted[base] + rest * (sorted[base + 1] - sorted[base]);\r\n    } else {\r\n        return sorted[base];\r\n    }\r\n};\r\n\r\nconst legend = (\r\n<div>\r\n  <h4>Social Connectedness</h4>\r\n<div><span style={{backgroundColor: colors[0]}}></span>{\"< 1x\"} <small>{\"(20th percentile)\"}</small></div>\r\n<div><span style={{backgroundColor: colors[1]}}></span>1-2x</div>\r\n<div><span style={{backgroundColor: colors[2]}}></span>2-3x</div>\r\n<div><span style={{backgroundColor: colors[3]}}></span>3-5x</div>\r\n<div><span style={{backgroundColor: colors[4]}}></span>5-10x</div>\r\n<div><span style={{backgroundColor: colors[5]}}></span>10-25x</div>\r\n<div><span style={{backgroundColor: colors[6]}}></span>25-100x</div>\r\n<div><span style={{backgroundColor: colors[7]}}></span>{\">= 100x\"}</div>\r\n<div><span style={{backgroundColor: colors[8]}}></span>{\"Data not available\"}</div>\r\n</div>\r\n);\r\n\r\nconst tooltip = e => {\r\n  if (e.payload[0]) {\r\n  return ( <div className={classes.tooltip}> {e.payload[0].payload.region} <br/>SCI {e.payload[0].payload.sciScaled}x</div> ) }\r\n}\r\n\r\n\r\n//// Basic setting of the map\r\nclass Application extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      lng: 40,\r\n      lat: 30,\r\n      zoom: 2,\r\n      selectedCountry: \"NG\",\r\n      name: \"\",\r\n      region: \"Africa\",\r\n      button: \"From\",\r\n      rendered: \"\"\r\n    };\r\n  }\r\n\r\ncomponentDidMount() {\r\n//// Initial map setting\r\n\r\nlet sci=[];\r\nsciOriginal.map(e=>this.state.button===\"From\"? sci.push({start:e.start,end:e.end,sci:e.sci}) : sci.push({end:e.start,start:e.end,sci:e.sci}))\r\n\r\nlet selected = [];\r\nlet scidata= [];\r\nlet scidataRank = [];\r\nlet scidataRankRegion = {Africa:[],Americas:[],Asia:[],Europe:[],Oceania:[]}\r\nlet scidataRankRegionCode = {Africa:[],Americas:[],Asia:[],Europe:[],Oceania:[]}\r\nsci.map(e => e.start===this.state.selectedCountry? selected.push(e) : null)\r\nselected.map(e => {\r\n  scidata.push(e.sci)\r\n  scidataRank.push(e.sci)\r\n  scidataRankRegion[countryData[e.end][1]].push(e.sci)\r\n  scidataRankRegionCode[countryData[e.end][1]].push(e.end)\r\n})\r\n\r\n\r\nObject.keys(scidataRankRegion).map(\r\n  k => {\r\n    let sorted = scidataRankRegion[k].slice().sort((a,b) => b-a);\r\n    let rank_region=scidataRankRegion[k].map(v => sorted.indexOf(v)+1);\r\n    scidataRankRegion[k]=rank_region\r\n  }\r\n )\r\n\r\n     this.popUp = new mapboxgl.Popup({\r\n              closeButton: false,\r\n              closeOnClick: false\r\n          });\r\n\r\n     this.map = new mapboxgl.Map({\r\n      container: this.mapContainer,\r\n      style: 'mapbox://styles/mkmd/ckguwdhux0j7719p9rz2hpmpi', /// Select mapstyle from mapbox studio\r\n      center: [this.state.lng, this.state.lat],\r\n      zoom: this.state.zoom,\r\n      attributionControl: false\r\n    });\r\n                  let top5=scidata.sort((a,b) => b-a).slice(0,5);\r\n                  let sortedSCI=scidata.sort((a,b) => b-a);\r\n                  let rank_country=scidataRank.map(v => sortedSCI.indexOf(v)+1 );\r\n\r\n                  let percentile20 = quantile(scidata, .20)\r\n                  selected.map(e => {\r\n                    e.region=countryData[e.end][1]\r\n                    e.sciScaled= Math.round(e.sci/percentile20)\r\n                    if(e.sci===top5[0]) {top5_list[0]=e}\r\n                    else if(e.sci===top5[1]) {top5_list[1]=e}\r\n                    else if(e.sci===top5[2]) {top5_list[2]=e}\r\n                    else if(e.sci===top5[3]) {top5_list[3]=e}\r\n                    else if(e.sci===top5[4]) {top5_list[4]=e}\r\n                  })\r\n                                // Calculate the sums and group data (while tracking count)\r\n                  const reduced = selected.reduce(function(m, d){\r\n                      if(!m[d.region]){\r\n                        m[d.region] = {...d, count: 1};\r\n                        return m;\r\n                      }\r\n                      m[d.region].sciScaled += d.sciScaled;\r\n                      m[d.region].count += 1;\r\n                      return m;\r\n                   },{});\r\n\r\n                   // Create new array from grouped data and compute the average\r\n                      result = Object.keys(reduced).map(function(k){\r\n                       const item  = reduced[k];\r\n                       return {\r\n                           region: item.region,\r\n                           sciScaled: Math.round(item.sciScaled/item.count*100)/100,\r\n                       }\r\n                   })\r\n\r\n                   let matchExpression = ['match', ['get', 'iso_3166_1']];\r\n\r\n                   // Calculate color values for each country based on 'hdi' value\r\n                   selected.forEach( e => {\r\n                   if(e.sci/percentile20 < 1) {matchExpression.push(e['end'], \"#F3F2E8\");}\r\n                   else if (e.sci/percentile20 < 2) {matchExpression.push(e['end'], \"#D4EBE2\");}\r\n                   else if (e.sci/percentile20 < 3) {matchExpression.push(e['end'], \"#B6E3DB\");}\r\n                   else if (e.sci/percentile20 < 5) {matchExpression.push(e['end'], \"#97DCD5\");}\r\n                   else if (e.sci/percentile20 < 10) {matchExpression.push(e['end'], \"#79D5CF\");}\r\n                   else if (e.sci/percentile20 < 25) {matchExpression.push(e['end'], \"#5ACEC9\");}\r\n                   else if (e.sci/percentile20 < 100) {matchExpression.push(e['end'], \"#3CC6C2\");}\r\n                   else {matchExpression.push(e['end'], \"#1DBFBC\");}\r\n                   });\r\n\r\n                   matchExpression.push(this.state.selectedCountry, '#e8ae40');\r\n                   // Last value is the default, used where there is no data\r\n                   matchExpression.push('rgba(0, 0, 0, 0)');\r\n                   // //console.log(this.state.selectedOption, prevState.selectedOption);\r\n\r\n                       this.map.on('load', () => {\r\n\r\n                         this.map.addControl(new mapboxgl.AttributionControl({customAttribution: \"Africapolis\"}));\r\n                   // Add Country shape\r\n                         this.map.addSource('africapolis_country', { type: 'vector', url: 'mapbox://mapbox.country-boundaries-v1'});\r\n\r\n                   // Add Country layer\r\n                         this.map.addLayer({\r\n                           id: 'country',\r\n                           source:'africapolis_country',\r\n                           type: 'fill',\r\n                           'source-layer':'country_boundaries',\r\n                           filter: [ \"match\", [\"get\", \"iso_3166_1\"], [\"TJ\",\"IR\",\"CN\", \"GL\", \"SJ\", \"TM\", \"EH\", \"KP\" ], false, true ],\r\n                           paint: {\r\n                             'fill-color': matchExpression,\r\n                             'fill-opacity': 0.9\r\n                           }\r\n                         });\r\n\r\n                           this.map.on('click', 'country', e =>  {\r\n                              this.popUp.remove()\r\n                              this.onUpdate(e.features[0].properties.iso_3166_1,e.features[0].properties.name_en,e.features[0].properties.region)\r\n                               });\r\n\r\n                           this.map.on('mousemove', 'country', e =>  {\r\n                              if(this.state.selectedCountry!==e.features[0].properties.iso_3166_1) {\r\n                              this.map.getCanvas().style.cursor = 'pointer';\r\n                              let coordinates = [e.lngLat.lng, e.lngLat.lat];\r\n                              let sciPopup=[];\r\n                              let rankPopup=[];\r\n                              let sciColor=[];\r\n                              let rankPopupRegion=[];\r\n                              let regionNumber=regionTotal[e.features[0].properties.region];\r\n\r\n                              selected.forEach( (d,i) => {\r\n                              if(d.end===e.features[0].properties.iso_3166_1) {\r\n                                sciPopup=Math.round(d.sci/percentile20)\r\n                                rankPopup=rank_country[i]\r\n\r\n                                if(d.sci/percentile20 < 1) {sciColor.push(\"#F3F2E8\");}\r\n                                else if (d.sci/percentile20 < 2) {sciColor.push(\"#D4EBE2\");}\r\n                                else if (d.sci/percentile20 < 3) {sciColor.push(\"#B6E3DB\");}\r\n                                else if (d.sci/percentile20 < 5) {sciColor.push(\"#97DCD5\");}\r\n                                else if (d.sci/percentile20 < 10) {sciColor.push(\"#79D5CF\");}\r\n                                else if (d.sci/percentile20 < 25) {sciColor.push(\"#5ACEC9\");}\r\n                                else if (d.sci/percentile20 < 100) {sciColor.push(\"#3CC6C2\");}\r\n                                else {sciColor.push(\"#1DBFBC\");}\r\n                              }\r\n                              });\r\n\r\n                            if(scidataRankRegionCode[e.features[0].properties.region]) {\r\n                              scidataRankRegionCode[e.features[0].properties.region].map(\r\n                                (d,i)=> e.features[0].properties.iso_3166_1===d? rankPopupRegion.push(scidataRankRegion[e.features[0].properties.region][i]) : null\r\n                            )}\r\n\r\n\r\n                          \t\tthis.popUp\r\n                                .setLngLat(coordinates)\r\n                          \t\t\t.setHTML(\r\n                                `<strong>${e.features[0].properties.name_en}</strong> ${sciPopup}<little>x</little><br/>\r\n                              <span>Rank:</span><bold>${rankPopup}</bold><span>/194</span><br/>\r\n                                <small>In ${e.features[0].properties.region}:</small><bold>${rankPopupRegion}</bold><span>/${regionNumber}</span>`\r\n                                )\r\n                          \t\t\t.addTo(this.map);\r\n                                var popupElem = this.popUp.getElement();\r\n                                popupElem.style.color = sciColor[0];\r\n                              } else {this.popUp.remove()}\r\n                            });\r\n\r\n                            this.map.on('mouseleave', 'country', e =>  {\r\n                              this.map.getCanvas().style.cursor = ''\r\n                              this.popUp.remove()\r\n                            });\r\n\r\n                       });\r\n\r\n                       this.setState({name: \"Nigeria\"})\r\n\r\n}\r\n\r\ncomponentDidUpdate(prevProps, prevState){\r\n  if(prevState.button !== this.state.button)\r\n  {this.onUpdate(this.state.selectedCountry, this.state.name, this.state.region)}\r\n}\r\n\r\nonUpdate = (ISO2, Name, Region) => {\r\n\r\n              this.setState({selectedCountry:ISO2})\r\n\r\n              let sci=[];\r\n              sciOriginal.map(e=>this.state.button===\"From\"? sci.push({start:e.start,end:e.end,sci:e.sci}) : sci.push({end:e.start,start:e.end,sci:e.sci}))\r\n\r\n\r\n              let selected = [];\r\n              let scidata= [];\r\n              let scidataRank = [];\r\n              let scidataRankRegion = {Africa:[],Americas:[],Asia:[],Europe:[],Oceania:[]}\r\n              let scidataRankRegionCode = {Africa:[],Americas:[],Asia:[],Europe:[],Oceania:[]}\r\n              sci.map(e => e.start===this.state.selectedCountry? selected.push(e) : null)\r\n              selected.map(e => {\r\n                scidata.push(e.sci)\r\n                scidataRank.push(e.sci)\r\n                scidataRankRegion[countryData[e.end][1]].push(e.sci)\r\n                scidataRankRegionCode[countryData[e.end][1]].push(e.end)\r\n\r\n              })\r\n\r\n\r\n              Object.keys(scidataRankRegion).map(\r\n                k => {\r\n                  let sorted = scidataRankRegion[k].slice().sort((a,b) => b-a);\r\n                  let rank_region=scidataRankRegion[k].map(v => sorted.indexOf(v)+1);\r\n                  scidataRankRegion[k]=rank_region\r\n                }\r\n               )\r\n\r\n\r\n              let percentile20 = quantile(scidata, .20)\r\n              //selected.map(e => e.sci = e.sci/ percentile20)\r\n\r\n              let sortedSCI=scidata.sort((a,b) => b-a);\r\n              let rank_country=scidataRank.map(v => sortedSCI.indexOf(v)+1 );\r\n              let top5=scidata.sort((a,b) => b-a).slice(0,5);\r\n              selected.map(e => {\r\n                e.region=countryData[e.end][1]\r\n                e.sciScaled= Math.round(e.sci/percentile20)\r\n                if(e.sci===top5[0]) {top5_list[0]=e}\r\n                else if(e.sci===top5[1]) {top5_list[1]=e}\r\n                else if(e.sci===top5[2]) {top5_list[2]=e}\r\n                else if(e.sci===top5[3]) {top5_list[3]=e}\r\n                else if(e.sci===top5[4]) {top5_list[4]=e}\r\n              })\r\n\r\n              //top5_list.map(e => e.sciScaled= Math.round(e.sci/percentile20))\r\n\r\n                            // Calculate the sums and group data (while tracking count)\r\n              const reduced = selected.reduce(function(m, d){\r\n                  if(!m[d.region]){\r\n                    m[d.region] = {...d, count: 1};\r\n                    return m;\r\n                  }\r\n                  m[d.region].sciScaled += d.sciScaled;\r\n                  m[d.region].count += 1;\r\n                  return m;\r\n               },{});\r\n\r\n               // Create new array from grouped data and compute the average\r\n                  result = Object.keys(reduced).map(function(k){\r\n                   const item  = reduced[k];\r\n                   return {\r\n                       region: item.region,\r\n                       sciScaled: Math.round(item.sciScaled/item.count*100)/100,\r\n                       numbers:item.count\r\n                   }\r\n               })\r\n\r\n            // console.log(JSON.stringify(result,null,4));\r\n\r\n              this.setState({name:Name,region:Region})\r\n\r\n              let matchExpression = ['match', ['get', 'iso_3166_1']];\r\n\r\n              // Calculate color values for each country based on 'hdi' value\r\n              selected.forEach( e => {\r\n              if(e.sci/percentile20 < 1) {matchExpression.push(e['end'], \"#F3F2E8\");}\r\n              else if (e.sci/percentile20 < 2) {matchExpression.push(e['end'], \"#D4EBE2\");}\r\n              else if (e.sci/percentile20 < 3) {matchExpression.push(e['end'], \"#B6E3DB\");}\r\n              else if (e.sci/percentile20 < 5) {matchExpression.push(e['end'], \"#97DCD5\");}\r\n              else if (e.sci/percentile20 < 10) {matchExpression.push(e['end'], \"#79D5CF\");}\r\n              else if (e.sci/percentile20 < 25) {matchExpression.push(e['end'], \"#5ACEC9\");}\r\n              else if (e.sci/percentile20 < 100) {matchExpression.push(e['end'], \"#3CC6C2\");}\r\n              else {matchExpression.push(e['end'], \"#1DBFBC\");}\r\n              });\r\n\r\n              matchExpression.push(this.state.selectedCountry, '#e8ae40');\r\n              // Last value is the default, used where there is no data\r\n              matchExpression.push('rgba(0, 0, 0, 0)');\r\n\r\n              // //console.log(this.state.selectedOption, prevState.selectedOption);\r\n\r\n              this.remove('country');\r\n\r\n              this.map.addLayer({\r\n                id: 'country',\r\n                source:'africapolis_country',\r\n                type: 'fill',\r\n                filter: [ \"match\", [\"get\", \"iso_3166_1\"], [\"IR\",\"CN\", \"GL\", \"SJ\", \"TM\", \"EH\", \"KP\",\"TJ\" ], false, true ],\r\n                'source-layer':'country_boundaries',\r\n                paint: {\r\n                  'fill-color': matchExpression,\r\n                  'fill-opacity': 0.9\r\n                }\r\n              });\r\n              this.map.on('mousemove', 'country', e =>  {\r\n                if(this.state.selectedCountry!==e.features[0].properties.iso_3166_1) {\r\n                this.map.getCanvas().style.cursor = 'pointer';\r\n                let coordinates = [e.lngLat.lng, e.lngLat.lat];\r\n                let sciPopup=[];\r\n                let rankPopup=[];\r\n                let sciColor=[];\r\n                let rankPopupRegion=[];\r\n                let regionNumber=regionTotal[e.features[0].properties.region];\r\n\r\n                selected.forEach( (d,i) => {\r\n                if(d.end===e.features[0].properties.iso_3166_1) {\r\n                  sciPopup=Math.round(d.sci/percentile20)\r\n                  rankPopup=rank_country[i]\r\n\r\n                  if(d.sci/percentile20 < 1) {sciColor.push(\"#F3F2E8\");}\r\n                  else if (d.sci/percentile20 < 2) {sciColor.push(\"#D4EBE2\");}\r\n                  else if (d.sci/percentile20 < 3) {sciColor.push(\"#B6E3DB\");}\r\n                  else if (d.sci/percentile20 < 5) {sciColor.push(\"#97DCD5\");}\r\n                  else if (d.sci/percentile20 < 10) {sciColor.push(\"#79D5CF\");}\r\n                  else if (d.sci/percentile20 < 25) {sciColor.push(\"#5ACEC9\");}\r\n                  else if (d.sci/percentile20 < 100) {sciColor.push(\"#3CC6C2\");}\r\n                  else {sciColor.push(\"#1DBFBC\");}\r\n                }\r\n                });\r\n\r\n              if(scidataRankRegionCode[e.features[0].properties.region]) {\r\n                scidataRankRegionCode[e.features[0].properties.region].map(\r\n                  (d,i)=> e.features[0].properties.iso_3166_1===d? rankPopupRegion.push(scidataRankRegion[e.features[0].properties.region][i]) : null\r\n              )}\r\n\r\n\r\n                this.popUp\r\n                  .setLngLat(coordinates)\r\n                  .setHTML(\r\n                  `<strong>${e.features[0].properties.name_en}</strong> ${sciPopup}<little>x</little><br/>\r\n                <span>Rank:</span><bold>${rankPopup}</bold><span>/194</span><br/>\r\n                  <small>In ${e.features[0].properties.region}:</small><bold>${rankPopupRegion}</bold><span>/${regionNumber}</span>`\r\n                  )\r\n                  .addTo(this.map);\r\n                  var popupElem = this.popUp.getElement();\r\n                  popupElem.style.color = sciColor[0];\r\n                } else {this.popUp.remove()}\r\n               });\r\n               this.setState({rendered:\"Yes\"})\r\n}\r\n\r\nremove = obj => {\r\n    this.map.removeLayer(obj)\r\n}\r\n\r\nmoveRegion = e => {\r\n      if(e) {\r\n      switch(e.activeLabel){\r\n      case 'Africa':\r\n      this.map.flyTo({center: [32.259 ,2.036], zoom:3.14, essential: true }); break;\r\n      case 'Americas':\r\n      this.map.flyTo({center: [-69.390 ,22.259], zoom:1.82, essential: true }); break;\r\n      case 'Asia':\r\n      this.map.flyTo({center: [104.687 ,32.592], zoom:3.14, essential: true }); break;\r\n      case 'Europe':\r\n      this.map.flyTo({center: [27.920 ,56.907], zoom:3.19, essential: true }); break;\r\n      case 'Oceania':\r\n      this.map.flyTo({center: [155.731 ,-16.435], zoom:3.11, essential: true }); break;\r\n      default:\r\n      return null;\r\n            }}\r\n}\r\n\r\n\r\n\r\n//5 Countries with the highest SCI\r\nrender() {\r\n    return (\r\n      <div>\r\n        <div className={classes.topleft}> <div className={classes.headwrapper}> <div className={classes.buttonwrapper}>\r\n          <button className={this.state.button===\"From\"? classes.buttonActive : classes.button} onClick={() => this.state.button===\"To\"? this.setState({button:\"From\"}) : null}>{\"From\"}</button>\r\n          <button className={this.state.button===\"To\"? classes.buttonActive : classes.button} onClick={() => this.state.button===\"From\"? this.setState({button:\"To\"}) : null}>{\"To\"}</button></div>\r\n          <headtitle> {this.state.name}</headtitle></div><br/>\r\n        <span>5 Most Connected Countries</span>\r\n        <table className={classes.table}>\r\n            <thead>\r\n              <tr>\r\n                <th>Country</th><th>SCI</th><th>Region</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {top5_list[0].end? top5_list.map((e,i)=>\r\n              <tr> <td>{countryData[top5_list[i].end][0]}</td> <td>{top5_list[i].sciScaled}x</td><td className={ countryData[top5_list[i].end][1]===this.state.region? classes.regionsel : classes.normal }>{countryData[top5_list[i].end][1]}</td></tr>\r\n              ) : null}\r\n            </tbody>\r\n          </table>\r\n        <br/> <span>Regional average</span>\r\n            <BarChart width={320} height={150} data={result.sort((a, b) => a.region.localeCompare(b.region))} style={{marginTop: \"10px\"}}  onClick={e => this.moveRegion(e)} >\r\n              <XAxis dataKey=\"region\" style={{ textAnchor: 'middle', fontSize: '100%', fill: 'rgba(255, 255, 255, 1)' }} />\r\n              <Tooltip content={tooltip} cursor={{fill: 'rgba(255, 255, 255, 0.3)'}} />\r\n              <Bar dataKey=\"sciScaled\" fill=\"#3CC6C2\" id=\"region\">\r\n                {result.map((entry,index) => (\r\n\t\t\t\t\t\t\t\t\t\t<Cell cursor=\"pointer\" key={`cell-${index}`} fill={entry.region ===  this.state.region ? '#e8ae40' : '#3CC6C2' } />\r\n\t\t\t\t\t\t\t\t\t))}\r\n  \t\t\t\t\t\t</Bar>\r\n  \t\t\t\t\t</BarChart>\r\n              <div className=\"VariableInfoWrapper\">\r\n                <a href=\"https://dataforgood.fb.com/tools/social-connectedness-index/#:~:text=The%20Social%20Connectedness%20Index%20measures,social%20mobility%2C%20trade%20and%20more.\">\r\n                  <MaterialIcon icon=\"info\"/>\r\n                </a>\r\n                  <span><strong>What is the Social Connectedness Index?</strong><br/>\r\n                  The Social Connectedness Index measures the strength of connectedness between two geographic areas as represented by Facebook friendship ties.<br/><br/>\r\n                  <strong>Methodology</strong><br/>\r\n                  We use aggregated friendship connections on Facebook to measure social connectedness between geographies. Locations are assigned to users based on information they provide, connection information, and location services they have opted into. We use these friendships to estimate the probability a pair of users in these countries are Facebook friends and map this to an index score called the Social Connectedness Index (SCI). If the SCI is twice as large between two pairs of regions, it means the users in the first region-pair are about twice as likely to be connected than the second region-pair.<br/><br/>\r\n                The figure shows a heat map of the social connectedness. For each country in our data, the colors highlight connections of the focal country, given in orange. The lightest color corresponds to the 20th percentile of the connectedness to the focal country; darker colors correspond to closer connections.               \r\n                <br/><br/><color>Click this button to check more detail and download the data on the Facebook page</color> </span>\r\n              </div>\r\n           </div>\r\n        <div ref={el => this.mapContainer = el} className={classes.mapContainer} />\r\n        <div className={classes.legend}>{legend}</div>\r\n          <a href=\"https://africapolis.org\">\r\n            <img className={classes.logo} src={logo} alt=\"Africapolis\"/>\r\n          </a>\r\n      </div>\r\n    )\r\n  }\r\n}\r\nReactDOM.render(<Application />, document.getElementById('app'));\r\n"]},"metadata":{},"sourceType":"module"}